var Vl=Object.defineProperty;var Pl=(l,e,t)=>e in l?Vl(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var ye=(l,e,t)=>Pl(l,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}})();function x(){}function wl(l){return l()}function Mt(){return Object.create(null)}function ke(l){l.forEach(wl)}function Ct(l){return typeof l=="function"}function Ne(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let et;function Pe(l,e){return l===e?!0:(et||(et=document.createElement("a")),et.href=e,l===et.href)}function Il(l){return Object.keys(l).length===0}function u(l,e){l.appendChild(e)}function A(l,e,t){l.insertBefore(e,t||null)}function w(l){l.parentNode&&l.parentNode.removeChild(l)}function Je(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function p(l){return document.createElement(l)}function M(l){return document.createTextNode(l)}function y(){return M(" ")}function wt(){return M("")}function H(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function h(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function Ol(l){return Array.from(l.childNodes)}function T(l,e){e=""+e,l.data!==e&&(l.data=e)}function Q(l,e){l.value=e??""}function qe(l,e,t){for(let n=0;n<l.options.length;n+=1){const s=l.options[n];if(s.__value===e){s.selected=!0;return}}(!t||e!==void 0)&&(l.selectedIndex=-1)}function Ge(l,e){for(let t=0;t<l.options.length;t+=1){const n=l.options[t];n.selected=~e.indexOf(n.__value)}}function ft(l){const e=l.querySelector(":checked");return e&&e.__value}function dt(l){return[].map.call(l.querySelectorAll(":checked"),e=>e.__value)}function _e(l,e,t){l.classList.toggle(e,!!t)}let xe;function Ze(l){xe=l}function Nl(){if(!xe)throw new Error("Function called outside component initialization");return xe}function Al(l){Nl().$$.on_mount.push(l)}const We=[],St=[];let $e=[];const Dt=[],Hl=Promise.resolve();let pt=!1;function Ul(){pt||(pt=!0,Hl.then(El))}function Be(l){$e.push(l)}const ht=new Set;let Ye=0;function El(){if(Ye!==0)return;const l=xe;do{try{for(;Ye<We.length;){const e=We[Ye];Ye++,Ze(e),ql(e.$$)}}catch(e){throw We.length=0,Ye=0,e}for(Ze(null),We.length=0,Ye=0;St.length;)St.pop()();for(let e=0;e<$e.length;e+=1){const t=$e[e];ht.has(t)||(ht.add(t),t())}$e.length=0}while(We.length);for(;Dt.length;)Dt.pop()();pt=!1,ht.clear(),Ze(l)}function ql(l){if(l.fragment!==null){l.update(),ke(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(Be)}}function Yl(l){const e=[],t=[];$e.forEach(n=>l.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),$e=e}const st=new Set;let Ve;function ct(){Ve={r:0,c:[],p:Ve}}function ut(){Ve.r||ke(Ve.c),Ve=Ve.p}function ae(l,e){l&&l.i&&(st.delete(l),l.i(e))}function pe(l,e,t,n){if(l&&l.o){if(st.has(l))return;st.add(l),Ve.c.push(()=>{st.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}function me(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function Kl(l,e){pe(l,1,1,()=>{e.delete(l.key)})}function Wl(l,e,t,n,s,i,o,r,c,a,f,d){let _=l.length,m=i.length,g=_;const k={};for(;g--;)k[l[g].key]=g;const b=[],C=new Map,v=new Map,E=[];for(g=m;g--;){const F=d(s,i,g),D=t(F);let j=o.get(D);j?E.push(()=>j.p(F,e)):(j=a(D,F),j.c()),C.set(D,b[g]=j),D in k&&v.set(D,Math.abs(g-k[D]))}const S=new Set,L=new Set;function O(F){ae(F,1),F.m(r,f),o.set(F.key,F),f=F.first,m--}for(;_&&m;){const F=b[m-1],D=l[_-1],j=F.key,P=D.key;F===D?(f=F.first,_--,m--):C.has(P)?!o.has(j)||S.has(j)?O(F):L.has(P)?_--:v.get(j)>v.get(P)?(L.add(j),O(F)):(S.add(P),_--):(c(D,o),_--)}for(;_--;){const F=l[_];C.has(F.key)||c(F,o)}for(;m;)O(b[m-1]);return ke(E),b}function Qe(l){l&&l.c()}function Ie(l,e,t){const{fragment:n,after_update:s}=l.$$;n&&n.m(e,t),Be(()=>{const i=l.$$.on_mount.map(wl).filter(Ct);l.$$.on_destroy?l.$$.on_destroy.push(...i):ke(i),l.$$.on_mount=[]}),s.forEach(Be)}function Oe(l,e){const t=l.$$;t.fragment!==null&&(Yl(t.after_update),ke(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function $l(l,e){l.$$.dirty[0]===-1&&(We.push(l),Ul(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function He(l,e,t,n,s,i,o=null,r=[-1]){const c=xe;Ze(l);const a=l.$$={fragment:null,ctx:[],props:i,update:x,not_equal:s,bound:Mt(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:Mt(),dirty:r,skip_bound:!1,root:e.target||c.$$.root};o&&o(a.root);let f=!1;if(a.ctx=t?t(l,e.props||{},(d,_,...m)=>{const g=m.length?m[0]:_;return a.ctx&&s(a.ctx[d],a.ctx[d]=g)&&(!a.skip_bound&&a.bound[d]&&a.bound[d](g),f&&$l(l,d)),_}):[],a.update(),f=!0,ke(a.before_update),a.fragment=n?n(a.ctx):!1,e.target){if(e.hydrate){const d=Ol(e.target);a.fragment&&a.fragment.l(d),d.forEach(w)}else a.fragment&&a.fragment.c();e.intro&&ae(l.$$.fragment),Ie(l,e.target,e.anchor),El()}Ze(c)}class Ue{constructor(){ye(this,"$$");ye(this,"$$set")}$destroy(){Oe(this,1),this.$destroy=x}$on(e,t){if(!Ct(t))return x;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const s=n.indexOf(t);s!==-1&&n.splice(s,1)}}$set(e){this.$$set&&!Il(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Gl="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Gl);function Ft(l){const e=l.split(/\r?\n/);if(e.length<2)return[];const t=e[0].split("	");return e.slice(1).filter(n=>n.trim()).map(n=>{const s=n.split("	");return Object.fromEntries(t.map((i,o)=>[i,s[o]||""]))})}function Ke(l,e=0){const t=parseInt(l,10);return isNaN(t)?e:t}class Ql{constructor(e=".."){ye(this,"baseUrl");ye(this,"videosCache",null);ye(this,"playlistsCache",null);ye(this,"metadataCache",new Map);ye(this,"commentsCache",new Map);this.baseUrl=e}async loadVideos(){if(this.videosCache)return this.videosCache;const e=await fetch(`${this.baseUrl}/videos/videos.tsv`);if(!e.ok)throw new Error(`Failed to load videos.tsv: ${e.statusText}`);const t=await e.text(),n=Ft(t);return this.videosCache=n.map(s=>this.parseTSVVideo(s)),this.videosCache}async loadPlaylists(){if(this.playlistsCache)return this.playlistsCache;const e=await fetch(`${this.baseUrl}/playlists/playlists.tsv`);if(!e.ok)throw new Error(`Failed to load playlists.tsv: ${e.statusText}`);const t=await e.text(),s=Ft(t).map(i=>this.parseTSVPlaylist(i));return await Promise.all(s.map(async i=>{try{const o=await this.loadPlaylistMetadata(i.playlist_id,i.path);i.video_ids=o.video_ids}catch(o){console.warn(`Could not load video_ids for playlist ${i.playlist_id}:`,o)}})),this.playlistsCache=s,this.playlistsCache}async loadVideoMetadata(e){if(this.metadataCache.has(e))return this.metadataCache.get(e);const t=this.getVideoPath(e),n=await fetch(`${this.baseUrl}/videos/${t}/metadata.json`);if(!n.ok)throw new Error(`Failed to load metadata for ${e}: ${n.statusText}`);const s=await n.json();if(this.videosCache){const i=this.videosCache.find(o=>o.video_id===e);i&&(s.file_path=t,s.download_status=i.download_status)}return this.metadataCache.set(e,s),s}async loadComments(e){if(this.commentsCache.has(e))return this.commentsCache.get(e);const t=this.getVideoPath(e),n=await fetch(`${this.baseUrl}/videos/${t}/comments.json`);if(!n.ok){if(n.status===404)return[];throw new Error(`Failed to load comments for ${e}: ${n.statusText}`)}const s=await n.json();return this.commentsCache.set(e,s),s}async loadPlaylistMetadata(e,t){let n=t||"";if(!n&&this.playlistsCache){const i=this.playlistsCache.find(o=>o.playlist_id===e);i&&i.path&&(n=i.path)}if(!n)throw new Error(`Cannot load playlist metadata for ${e}: path not found in cache`);const s=await fetch(`${this.baseUrl}/playlists/${n}/playlist.json`);if(!s.ok)throw new Error(`Failed to load playlist metadata for ${e}: ${s.statusText}`);return await s.json()}getCaptionPath(e,t){const n=this.getVideoPath(e);return`${this.baseUrl}/videos/${n}/caption_${t}.vtt`}getVideoPath(e){if(this.videosCache){const t=this.videosCache.find(n=>n.video_id===e);if(t&&t.file_path)return t.file_path}return e}clearCache(){this.videosCache=null,this.playlistsCache=null,this.metadataCache.clear(),this.commentsCache.clear()}parseTSVVideo(e){return{video_id:e.video_id,title:e.title,channel_id:e.channel_id,channel_name:e.channel_name,published_at:e.published_at,duration:Ke(e.duration),view_count:Ke(e.view_count),like_count:Ke(e.like_count),comment_count:Ke(e.comment_count),thumbnail_url:e.thumbnail_url,download_status:e.download_status,source_url:e.source_url,file_path:e.path||e.video_id,license:"standard",privacy_status:"public",availability:"public",tags:[],categories:[],captions_available:[],has_auto_captions:!1,fetched_at:new Date().toISOString(),updated_at:new Date().toISOString()}}parseTSVPlaylist(e){return{playlist_id:e.playlist_id,title:e.title,channel_id:e.channel_id,channel_name:e.channel_name,video_count:Ke(e.video_count),total_duration:Ke(e.total_duration),privacy_status:e.privacy_status,created_at:e.created_at,last_sync:e.last_sync,path:e.path,video_ids:[],updated_at:e.last_sync,fetched_at:e.last_sync}}}const it=new Ql;class Jl{constructor(){ye(this,"listeners",[]);ye(this,"currentRoute",{name:"home",params:{}});window.addEventListener("hashchange",()=>this.handleHashChange()),this.handleHashChange()}subscribe(e){return this.listeners.push(e),e(this.currentRoute),()=>{const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}navigate(e,t={}){e==="home"?window.location.hash="#/":e==="video"&&(window.location.hash=`#/video/${t.video_id}`)}getCurrentRoute(){return this.currentRoute}handleHashChange(){const e=window.location.hash.slice(1),t=this.parseHash(e);this.currentRoute=t,this.notifyListeners(t)}parseHash(e){const t=e.startsWith("/")?e.slice(1):e;if(!t||t==="/")return{name:"home",params:{}};const n=t.match(/^video\/([^/]+)$/);return n?{name:"video",params:{video_id:n[1]}}:{name:"home",params:{}}}notifyListeners(e){this.listeners.forEach(t=>t(e))}}const tt=new Jl;function ze(l){return Array.isArray?Array.isArray(l):Dl(l)==="[object Array]"}function Xl(l){if(typeof l=="string")return l;let e=l+"";return e=="0"&&1/l==-1/0?"-0":e}function Zl(l){return l==null?"":Xl(l)}function De(l){return typeof l=="string"}function Ml(l){return typeof l=="number"}function xl(l){return l===!0||l===!1||en(l)&&Dl(l)=="[object Boolean]"}function Sl(l){return typeof l=="object"}function en(l){return Sl(l)&&l!==null}function be(l){return l!=null}function _t(l){return!l.trim().length}function Dl(l){return l==null?l===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(l)}const tn="Incorrect 'index' type",ln=l=>`Invalid value for key ${l}`,nn=l=>`Pattern length exceeds max of ${l}.`,sn=l=>`Missing ${l} property in key`,on=l=>`Property 'weight' in key '${l}' must be a positive integer`,Bt=Object.prototype.hasOwnProperty;class rn{constructor(e){this._keys=[],this._keyMap={};let t=0;e.forEach(n=>{let s=Fl(n);this._keys.push(s),this._keyMap[s.id]=s,t+=s.weight}),this._keys.forEach(n=>{n.weight/=t})}get(e){return this._keyMap[e]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function Fl(l){let e=null,t=null,n=null,s=1,i=null;if(De(l)||ze(l))n=l,e=zt(l),t=mt(l);else{if(!Bt.call(l,"name"))throw new Error(sn("name"));const o=l.name;if(n=o,Bt.call(l,"weight")&&(s=l.weight,s<=0))throw new Error(on(o));e=zt(o),t=mt(o),i=l.getFn}return{path:e,id:t,weight:s,src:n,getFn:i}}function zt(l){return ze(l)?l:l.split(".")}function mt(l){return ze(l)?l.join("."):l}function an(l,e){let t=[],n=!1;const s=(i,o,r)=>{if(be(i))if(!o[r])t.push(i);else{let c=o[r];const a=i[c];if(!be(a))return;if(r===o.length-1&&(De(a)||Ml(a)||xl(a)))t.push(Zl(a));else if(ze(a)){n=!0;for(let f=0,d=a.length;f<d;f+=1)s(a[f],o,r+1)}else o.length&&s(a,o,r+1)}};return s(l,De(e)?e.split("."):e,0),n?t:t[0]}const cn={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},un={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(l,e)=>l.score===e.score?l.idx<e.idx?-1:1:l.score<e.score?-1:1},fn={location:0,threshold:.6,distance:100},dn={useExtendedSearch:!1,getFn:an,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var B={...un,...cn,...fn,...dn};const hn=/[^ ]+/g;function _n(l=1,e=3){const t=new Map,n=Math.pow(10,e);return{get(s){const i=s.match(hn).length;if(t.has(i))return t.get(i);const o=1/Math.pow(i,.5*l),r=parseFloat(Math.round(o*n)/n);return t.set(i,r),r},clear(){t.clear()}}}class At{constructor({getFn:e=B.getFn,fieldNormWeight:t=B.fieldNormWeight}={}){this.norm=_n(t,3),this.getFn=e,this.isCreated=!1,this.setIndexRecords()}setSources(e=[]){this.docs=e}setIndexRecords(e=[]){this.records=e}setKeys(e=[]){this.keys=e,this._keysMap={},e.forEach((t,n)=>{this._keysMap[t.id]=n})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,De(this.docs[0])?this.docs.forEach((e,t)=>{this._addString(e,t)}):this.docs.forEach((e,t)=>{this._addObject(e,t)}),this.norm.clear())}add(e){const t=this.size();De(e)?this._addString(e,t):this._addObject(e,t)}removeAt(e){this.records.splice(e,1);for(let t=e,n=this.size();t<n;t+=1)this.records[t].i-=1}getValueForItemAtKeyId(e,t){return e[this._keysMap[t]]}size(){return this.records.length}_addString(e,t){if(!be(e)||_t(e))return;let n={v:e,i:t,n:this.norm.get(e)};this.records.push(n)}_addObject(e,t){let n={i:t,$:{}};this.keys.forEach((s,i)=>{let o=s.getFn?s.getFn(e):this.getFn(e,s.path);if(be(o)){if(ze(o)){let r=[];const c=[{nestedArrIndex:-1,value:o}];for(;c.length;){const{nestedArrIndex:a,value:f}=c.pop();if(be(f))if(De(f)&&!_t(f)){let d={v:f,i:a,n:this.norm.get(f)};r.push(d)}else ze(f)&&f.forEach((d,_)=>{c.push({nestedArrIndex:_,value:d})})}n.$[i]=r}else if(De(o)&&!_t(o)){let r={v:o,n:this.norm.get(o)};n.$[i]=r}}}),this.records.push(n)}toJSON(){return{keys:this.keys,records:this.records}}}function Bl(l,e,{getFn:t=B.getFn,fieldNormWeight:n=B.fieldNormWeight}={}){const s=new At({getFn:t,fieldNormWeight:n});return s.setKeys(l.map(Fl)),s.setSources(e),s.create(),s}function pn(l,{getFn:e=B.getFn,fieldNormWeight:t=B.fieldNormWeight}={}){const{keys:n,records:s}=l,i=new At({getFn:e,fieldNormWeight:t});return i.setKeys(n),i.setIndexRecords(s),i}function lt(l,{errors:e=0,currentLocation:t=0,expectedLocation:n=0,distance:s=B.distance,ignoreLocation:i=B.ignoreLocation}={}){const o=e/l.length;if(i)return o;const r=Math.abs(n-t);return s?o+r/s:r?1:o}function mn(l=[],e=B.minMatchCharLength){let t=[],n=-1,s=-1,i=0;for(let o=l.length;i<o;i+=1){let r=l[i];r&&n===-1?n=i:!r&&n!==-1&&(s=i-1,s-n+1>=e&&t.push([n,s]),n=-1)}return l[i-1]&&i-n>=e&&t.push([n,i-1]),t}const Re=32;function gn(l,e,t,{location:n=B.location,distance:s=B.distance,threshold:i=B.threshold,findAllMatches:o=B.findAllMatches,minMatchCharLength:r=B.minMatchCharLength,includeMatches:c=B.includeMatches,ignoreLocation:a=B.ignoreLocation}={}){if(e.length>Re)throw new Error(nn(Re));const f=e.length,d=l.length,_=Math.max(0,Math.min(n,d));let m=i,g=_;const k=r>1||c,b=k?Array(d):[];let C;for(;(C=l.indexOf(e,g))>-1;){let F=lt(e,{currentLocation:C,expectedLocation:_,distance:s,ignoreLocation:a});if(m=Math.min(F,m),g=C+f,k){let D=0;for(;D<f;)b[C+D]=1,D+=1}}g=-1;let v=[],E=1,S=f+d;const L=1<<f-1;for(let F=0;F<f;F+=1){let D=0,j=S;for(;D<j;)lt(e,{errors:F,currentLocation:_+j,expectedLocation:_,distance:s,ignoreLocation:a})<=m?D=j:S=j,j=Math.floor((S-D)/2+D);S=j;let P=Math.max(1,_-j+1),z=o?d:Math.min(_+j,d)+f,R=Array(z+2);R[z+1]=(1<<F)-1;for(let q=z;q>=P;q-=1){let K=q-1,le=t[l.charAt(K)];if(k&&(b[K]=+!!le),R[q]=(R[q+1]<<1|1)&le,F&&(R[q]|=(v[q+1]|v[q])<<1|1|v[q+1]),R[q]&L&&(E=lt(e,{errors:F,currentLocation:K,expectedLocation:_,distance:s,ignoreLocation:a}),E<=m)){if(m=E,g=K,g<=_)break;P=Math.max(1,2*_-g)}}if(lt(e,{errors:F+1,currentLocation:_,expectedLocation:_,distance:s,ignoreLocation:a})>m)break;v=R}const O={isMatch:g>=0,score:Math.max(.001,E)};if(k){const F=mn(b,r);F.length?c&&(O.indices=F):O.isMatch=!1}return O}function vn(l){let e={};for(let t=0,n=l.length;t<n;t+=1){const s=l.charAt(t);e[s]=(e[s]||0)|1<<n-t-1}return e}const ot=String.prototype.normalize?l=>l.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):l=>l;class zl{constructor(e,{location:t=B.location,threshold:n=B.threshold,distance:s=B.distance,includeMatches:i=B.includeMatches,findAllMatches:o=B.findAllMatches,minMatchCharLength:r=B.minMatchCharLength,isCaseSensitive:c=B.isCaseSensitive,ignoreDiacritics:a=B.ignoreDiacritics,ignoreLocation:f=B.ignoreLocation}={}){if(this.options={location:t,threshold:n,distance:s,includeMatches:i,findAllMatches:o,minMatchCharLength:r,isCaseSensitive:c,ignoreDiacritics:a,ignoreLocation:f},e=c?e:e.toLowerCase(),e=a?ot(e):e,this.pattern=e,this.chunks=[],!this.pattern.length)return;const d=(m,g)=>{this.chunks.push({pattern:m,alphabet:vn(m),startIndex:g})},_=this.pattern.length;if(_>Re){let m=0;const g=_%Re,k=_-g;for(;m<k;)d(this.pattern.substr(m,Re),m),m+=Re;if(g){const b=_-Re;d(this.pattern.substr(b),b)}}else d(this.pattern,0)}searchIn(e){const{isCaseSensitive:t,ignoreDiacritics:n,includeMatches:s}=this.options;if(e=t?e:e.toLowerCase(),e=n?ot(e):e,this.pattern===e){let k={isMatch:!0,score:0};return s&&(k.indices=[[0,e.length-1]]),k}const{location:i,distance:o,threshold:r,findAllMatches:c,minMatchCharLength:a,ignoreLocation:f}=this.options;let d=[],_=0,m=!1;this.chunks.forEach(({pattern:k,alphabet:b,startIndex:C})=>{const{isMatch:v,score:E,indices:S}=gn(e,k,b,{location:i+C,distance:o,threshold:r,findAllMatches:c,minMatchCharLength:a,includeMatches:s,ignoreLocation:f});v&&(m=!0),_+=E,v&&S&&(d=[...d,...S])});let g={isMatch:m,score:m?_/this.chunks.length:1};return m&&s&&(g.indices=d),g}}class Le{constructor(e){this.pattern=e}static isMultiMatch(e){return Tt(e,this.multiRegex)}static isSingleMatch(e){return Tt(e,this.singleRegex)}search(){}}function Tt(l,e){const t=l.match(e);return t?t[1]:null}class bn extends Le{constructor(e){super(e)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(e){const t=e===this.pattern;return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class yn extends Le{constructor(e){super(e)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(e){const n=e.indexOf(this.pattern)===-1;return{isMatch:n,score:n?0:1,indices:[0,e.length-1]}}}class kn extends Le{constructor(e){super(e)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(e){const t=e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,this.pattern.length-1]}}}class Cn extends Le{constructor(e){super(e)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(e){const t=!e.startsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class wn extends Le{constructor(e){super(e)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(e){const t=e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[e.length-this.pattern.length,e.length-1]}}}class An extends Le{constructor(e){super(e)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(e){const t=!e.endsWith(this.pattern);return{isMatch:t,score:t?0:1,indices:[0,e.length-1]}}}class Tl extends Le{constructor(e,{location:t=B.location,threshold:n=B.threshold,distance:s=B.distance,includeMatches:i=B.includeMatches,findAllMatches:o=B.findAllMatches,minMatchCharLength:r=B.minMatchCharLength,isCaseSensitive:c=B.isCaseSensitive,ignoreDiacritics:a=B.ignoreDiacritics,ignoreLocation:f=B.ignoreLocation}={}){super(e),this._bitapSearch=new zl(e,{location:t,threshold:n,distance:s,includeMatches:i,findAllMatches:o,minMatchCharLength:r,isCaseSensitive:c,ignoreDiacritics:a,ignoreLocation:f})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(e){return this._bitapSearch.searchIn(e)}}class Ll extends Le{constructor(e){super(e)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(e){let t=0,n;const s=[],i=this.pattern.length;for(;(n=e.indexOf(this.pattern,t))>-1;)t=n+i,s.push([n,t-1]);const o=!!s.length;return{isMatch:o,score:o?0:1,indices:s}}}const gt=[bn,Ll,kn,Cn,An,wn,yn,Tl],Lt=gt.length,En=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,Mn="|";function Sn(l,e={}){return l.split(Mn).map(t=>{let n=t.trim().split(En).filter(i=>i&&!!i.trim()),s=[];for(let i=0,o=n.length;i<o;i+=1){const r=n[i];let c=!1,a=-1;for(;!c&&++a<Lt;){const f=gt[a];let d=f.isMultiMatch(r);d&&(s.push(new f(d,e)),c=!0)}if(!c)for(a=-1;++a<Lt;){const f=gt[a];let d=f.isSingleMatch(r);if(d){s.push(new f(d,e));break}}}return s})}const Dn=new Set([Tl.type,Ll.type]);class Fn{constructor(e,{isCaseSensitive:t=B.isCaseSensitive,ignoreDiacritics:n=B.ignoreDiacritics,includeMatches:s=B.includeMatches,minMatchCharLength:i=B.minMatchCharLength,ignoreLocation:o=B.ignoreLocation,findAllMatches:r=B.findAllMatches,location:c=B.location,threshold:a=B.threshold,distance:f=B.distance}={}){this.query=null,this.options={isCaseSensitive:t,ignoreDiacritics:n,includeMatches:s,minMatchCharLength:i,findAllMatches:r,ignoreLocation:o,location:c,threshold:a,distance:f},e=t?e:e.toLowerCase(),e=n?ot(e):e,this.pattern=e,this.query=Sn(this.pattern,this.options)}static condition(e,t){return t.useExtendedSearch}searchIn(e){const t=this.query;if(!t)return{isMatch:!1,score:1};const{includeMatches:n,isCaseSensitive:s,ignoreDiacritics:i}=this.options;e=s?e:e.toLowerCase(),e=i?ot(e):e;let o=0,r=[],c=0;for(let a=0,f=t.length;a<f;a+=1){const d=t[a];r.length=0,o=0;for(let _=0,m=d.length;_<m;_+=1){const g=d[_],{isMatch:k,indices:b,score:C}=g.search(e);if(k){if(o+=1,c+=C,n){const v=g.constructor.type;Dn.has(v)?r=[...r,...b]:r.push(b)}}else{c=0,o=0,r.length=0;break}}if(o){let _={isMatch:!0,score:c/o};return n&&(_.indices=r),_}}return{isMatch:!1,score:1}}}const vt=[];function Bn(...l){vt.push(...l)}function bt(l,e){for(let t=0,n=vt.length;t<n;t+=1){let s=vt[t];if(s.condition(l,e))return new s(l,e)}return new zl(l,e)}const rt={AND:"$and",OR:"$or"},yt={PATH:"$path",PATTERN:"$val"},kt=l=>!!(l[rt.AND]||l[rt.OR]),zn=l=>!!l[yt.PATH],Tn=l=>!ze(l)&&Sl(l)&&!kt(l),jt=l=>({[rt.AND]:Object.keys(l).map(e=>({[e]:l[e]}))});function jl(l,e,{auto:t=!0}={}){const n=s=>{let i=Object.keys(s);const o=zn(s);if(!o&&i.length>1&&!kt(s))return n(jt(s));if(Tn(s)){const c=o?s[yt.PATH]:i[0],a=o?s[yt.PATTERN]:s[c];if(!De(a))throw new Error(ln(c));const f={keyId:mt(c),pattern:a};return t&&(f.searcher=bt(a,e)),f}let r={children:[],operator:i[0]};return i.forEach(c=>{const a=s[c];ze(a)&&a.forEach(f=>{r.children.push(n(f))})}),r};return kt(l)||(l=jt(l)),n(l)}function Ln(l,{ignoreFieldNorm:e=B.ignoreFieldNorm}){l.forEach(t=>{let n=1;t.matches.forEach(({key:s,norm:i,score:o})=>{const r=s?s.weight:null;n*=Math.pow(o===0&&r?Number.EPSILON:o,(r||1)*(e?1:i))}),t.score=n})}function jn(l,e){const t=l.matches;e.matches=[],be(t)&&t.forEach(n=>{if(!be(n.indices)||!n.indices.length)return;const{indices:s,value:i}=n;let o={indices:s,value:i};n.key&&(o.key=n.key.src),n.idx>-1&&(o.refIndex=n.idx),e.matches.push(o)})}function Rn(l,e){e.score=l.score}function Vn(l,e,{includeMatches:t=B.includeMatches,includeScore:n=B.includeScore}={}){const s=[];return t&&s.push(jn),n&&s.push(Rn),l.map(i=>{const{idx:o}=i,r={item:e[o],refIndex:o};return s.length&&s.forEach(c=>{c(i,r)}),r})}class Xe{constructor(e,t={},n){this.options={...B,...t},this.options.useExtendedSearch,this._keyStore=new rn(this.options.keys),this.setCollection(e,n)}setCollection(e,t){if(this._docs=e,t&&!(t instanceof At))throw new Error(tn);this._myIndex=t||Bl(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(e){be(e)&&(this._docs.push(e),this._myIndex.add(e))}remove(e=()=>!1){const t=[];for(let n=0,s=this._docs.length;n<s;n+=1){const i=this._docs[n];e(i,n)&&(this.removeAt(n),n-=1,s-=1,t.push(i))}return t}removeAt(e){this._docs.splice(e,1),this._myIndex.removeAt(e)}getIndex(){return this._myIndex}search(e,{limit:t=-1}={}){const{includeMatches:n,includeScore:s,shouldSort:i,sortFn:o,ignoreFieldNorm:r}=this.options;let c=De(e)?De(this._docs[0])?this._searchStringList(e):this._searchObjectList(e):this._searchLogical(e);return Ln(c,{ignoreFieldNorm:r}),i&&c.sort(o),Ml(t)&&t>-1&&(c=c.slice(0,t)),Vn(c,this._docs,{includeMatches:n,includeScore:s})}_searchStringList(e){const t=bt(e,this.options),{records:n}=this._myIndex,s=[];return n.forEach(({v:i,i:o,n:r})=>{if(!be(i))return;const{isMatch:c,score:a,indices:f}=t.searchIn(i);c&&s.push({item:i,idx:o,matches:[{score:a,value:i,norm:r,indices:f}]})}),s}_searchLogical(e){const t=jl(e,this.options),n=(r,c,a)=>{if(!r.children){const{keyId:d,searcher:_}=r,m=this._findMatches({key:this._keyStore.get(d),value:this._myIndex.getValueForItemAtKeyId(c,d),searcher:_});return m&&m.length?[{idx:a,item:c,matches:m}]:[]}const f=[];for(let d=0,_=r.children.length;d<_;d+=1){const m=r.children[d],g=n(m,c,a);if(g.length)f.push(...g);else if(r.operator===rt.AND)return[]}return f},s=this._myIndex.records,i={},o=[];return s.forEach(({$:r,i:c})=>{if(be(r)){let a=n(t,r,c);a.length&&(i[c]||(i[c]={idx:c,item:r,matches:[]},o.push(i[c])),a.forEach(({matches:f})=>{i[c].matches.push(...f)}))}}),o}_searchObjectList(e){const t=bt(e,this.options),{keys:n,records:s}=this._myIndex,i=[];return s.forEach(({$:o,i:r})=>{if(!be(o))return;let c=[];n.forEach((a,f)=>{c.push(...this._findMatches({key:a,value:o[f],searcher:t}))}),c.length&&i.push({idx:r,item:o,matches:c})}),i}_findMatches({key:e,value:t,searcher:n}){if(!be(t))return[];let s=[];if(ze(t))t.forEach(({v:i,i:o,n:r})=>{if(!be(i))return;const{isMatch:c,score:a,indices:f}=n.searchIn(i);c&&s.push({score:a,key:e,value:i,idx:o,norm:r,indices:f})});else{const{v:i,n:o}=t,{isMatch:r,score:c,indices:a}=n.searchIn(i);r&&s.push({score:c,key:e,value:i,norm:o,indices:a})}return s}}Xe.version="7.1.0";Xe.createIndex=Bl;Xe.parseIndex=pn;Xe.config=B;Xe.parseQuery=jl;Bn(Fn);class Pn{constructor(){ye(this,"fuse",null);ye(this,"videos",[])}initialize(e){this.videos=e,this.fuse=new Xe(e,{keys:[{name:"title",weight:.4},{name:"channel_name",weight:.2},{name:"tags",weight:.3},{name:"description",weight:.1}],threshold:.3,includeScore:!0,includeMatches:!0,ignoreLocation:!0,minMatchCharLength:2})}search(e,t){if(!this.fuse||!e.trim())return this.videos.map(i=>({video:i,score:0,matches:[]}));const s=this.fuse.search(e).map(i=>{var o;return{video:i.item,score:i.score||0,matches:((o=i.matches)==null?void 0:o.map(r=>r.key||""))||[]}});return t!=null&&t.limit&&t.limit>0?s.slice(0,t.limit):s}clear(){this.fuse=null,this.videos=[]}getIndexedCount(){return this.videos.length}}const Rl=new Pn;function Rt(l){const e=Math.floor(l/3600),t=Math.floor(l%3600/60),n=l%60;return e>0?`${e}:${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`:`${t}:${String(n).padStart(2,"0")}`}function at(l){return l>=1e9?`${(l/1e9).toFixed(1)}B views`:l>=1e6?`${(l/1e6).toFixed(1)}M views`:l>=1e3?`${(l/1e3).toFixed(1)}K views`:`${l} views`}function Te(l){let e;typeof l=="number"?e=new Date(l*1e3):e=new Date(l);const n=new Date().getTime()-e.getTime(),s=Math.floor(n/1e3),i=Math.floor(s/60),o=Math.floor(i/60),r=Math.floor(o/24),c=Math.floor(r/30),a=Math.floor(r/365);return a>0?`${a} year${a>1?"s":""} ago`:c>0?`${c} month${c>1?"s":""} ago`:r>0?`${r} day${r>1?"s":""} ago`:o>0?`${o} hour${o>1?"s":""} ago`:i>0?`${i} minute${i>1?"s":""} ago`:"Just now"}function Vt(l){return l===0?"":l>=1e3?`${(l/1e3).toFixed(1)}K comments`:`${l} comment${l!==1?"s":""}`}function In(l){let e,t,n,s,i;return{c(){e=p("img"),Pe(e.src,t=l[0].thumbnail_url)||h(e,"src",t),h(e,"alt",n=l[0].title),h(e,"class","thumbnail svelte-16jifoe"),h(e,"loading","lazy")},m(o,r){A(o,e,r),s||(i=H(e,"error",l[3]),s=!0)},p(o,r){r&1&&!Pe(e.src,t=o[0].thumbnail_url)&&h(e,"src",t),r&1&&n!==(n=o[0].title)&&h(e,"alt",n)},d(o){o&&w(e),s=!1,i()}}}function On(l){let e;return{c(){e=p("div"),e.innerHTML='<svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg> <span class="placeholder-text svelte-16jifoe">No thumbnail</span>',h(e,"class","thumbnail-placeholder svelte-16jifoe")},m(t,n){A(t,e,n)},p:x,d(t){t&&w(e)}}}function Nn(l){let e;return{c(){e=p("div"),e.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-16jifoe"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>',h(e,"class","status-badge metadata-only svelte-16jifoe"),h(e,"title","Metadata only (no video file)")},m(t,n){A(t,e,n)},d(t){t&&w(e)}}}function Hn(l){let e;return{c(){e=p("div"),e.innerHTML='<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="svelte-16jifoe"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="7 10 12 15 17 10"></polyline><line x1="12" y1="15" x2="12" y2="3"></line></svg>',h(e,"class","status-badge downloaded svelte-16jifoe"),h(e,"title","Video available locally")},m(t,n){A(t,e,n)},d(t){t&&w(e)}}}function Pt(l){let e,t,n,s=Vt(l[0].comment_count)+"",i;return{c(){e=p("span"),e.textContent="‚Ä¢",t=y(),n=p("span"),i=M(s),h(e,"class","separator svelte-16jifoe"),h(n,"class","comments")},m(o,r){A(o,e,r),A(o,t,r),A(o,n,r),u(n,i)},p(o,r){r&1&&s!==(s=Vt(o[0].comment_count)+"")&&T(i,s)},d(o){o&&(w(e),w(t),w(n))}}}function Un(l){let e,t,n,s,i,o=Rt(l[0].duration)+"",r,c,a,f,d=l[0].title+"",_,m,g,k=l[0].channel_name+"",b,C,v,E,S=at(l[0].view_count)+"",L,O,F,D,j,P,z=Te(l[0].published_at)+"",R,$,q;function K(N,G){return N[2]?On:In}let le=K(l),Z=le(l);function te(N,G){if(N[0].download_status==="downloaded")return Hn;if(N[0].download_status==="metadata_only")return Nn}let J=te(l),Y=J&&J(l),U=l[0].comment_count>0&&Pt(l);return{c(){e=p("div"),t=p("div"),Z.c(),n=y(),Y&&Y.c(),s=y(),i=p("div"),r=M(o),c=y(),a=p("div"),f=p("h3"),_=M(d),m=y(),g=p("div"),b=M(k),C=y(),v=p("div"),E=p("span"),L=M(S),O=y(),U&&U.c(),F=y(),D=p("span"),D.textContent="‚Ä¢",j=y(),P=p("span"),R=M(z),h(i,"class","duration svelte-16jifoe"),h(t,"class","thumbnail-container svelte-16jifoe"),h(f,"class","title svelte-16jifoe"),h(g,"class","channel svelte-16jifoe"),h(E,"class","views"),h(D,"class","separator svelte-16jifoe"),h(P,"class","date"),h(v,"class","metadata svelte-16jifoe"),h(a,"class","info svelte-16jifoe"),h(e,"class","video-card svelte-16jifoe"),h(e,"role","button"),h(e,"tabindex","0")},m(N,G){A(N,e,G),u(e,t),Z.m(t,null),u(t,n),Y&&Y.m(t,null),u(t,s),u(t,i),u(i,r),u(e,c),u(e,a),u(a,f),u(f,_),u(a,m),u(a,g),u(g,b),u(a,C),u(a,v),u(v,E),u(E,L),u(v,O),U&&U.m(v,null),u(v,F),u(v,D),u(v,j),u(v,P),u(P,R),$||(q=[H(e,"click",l[5]),H(e,"keydown",l[4])],$=!0)},p(N,[G]){le===(le=K(N))&&Z?Z.p(N,G):(Z.d(1),Z=le(N),Z&&(Z.c(),Z.m(t,n))),J!==(J=te(N))&&(Y&&Y.d(1),Y=J&&J(N),Y&&(Y.c(),Y.m(t,s))),G&1&&o!==(o=Rt(N[0].duration)+"")&&T(r,o),G&1&&d!==(d=N[0].title+"")&&T(_,d),G&1&&k!==(k=N[0].channel_name+"")&&T(b,k),G&1&&S!==(S=at(N[0].view_count)+"")&&T(L,S),N[0].comment_count>0?U?U.p(N,G):(U=Pt(N),U.c(),U.m(v,F)):U&&(U.d(1),U=null),G&1&&z!==(z=Te(N[0].published_at)+"")&&T(R,z)},i:x,o:x,d(N){N&&w(e),Z.d(),Y&&Y.d(),U&&U.d(),$=!1,ke(q)}}}function qn(l,e,t){let{video:n}=e,{onClick:s=()=>{}}=e,i=!1;function o(){t(2,i=!0)}function r(a){(a.key==="Enter"||a.key===" ")&&(a.preventDefault(),s(n))}const c=()=>s(n);return l.$$set=a=>{"video"in a&&t(0,n=a.video),"onClick"in a&&t(1,s=a.onClick)},[n,s,i,o,r,c]}class Yn extends Ue{constructor(e){super(),He(this,e,qn,Un,Ne,{video:0,onClick:1})}}function It(l,e,t){const n=l.slice();return n[6]=e[t],n}function Kn(l){let e,t,n=[],s=new Map,i,o=l[1]>0&&Ot(l),r=me(l[0]);const c=a=>a[6].video_id;for(let a=0;a<r.length;a+=1){let f=It(l,r,a),d=c(f);s.set(d,n[a]=Nt(d,f))}return{c(){o&&o.c(),e=y(),t=p("div");for(let a=0;a<n.length;a+=1)n[a].c();h(t,"class","video-grid svelte-1thvyca")},m(a,f){o&&o.m(a,f),A(a,e,f),A(a,t,f);for(let d=0;d<n.length;d+=1)n[d]&&n[d].m(t,null);i=!0},p(a,f){a[1]>0?o?o.p(a,f):(o=Ot(a),o.c(),o.m(e.parentNode,e)):o&&(o.d(1),o=null),f&5&&(r=me(a[0]),ct(),n=Wl(n,f,c,1,a,r,s,t,Kl,Nt,null,It),ut())},i(a){if(!i){for(let f=0;f<r.length;f+=1)ae(n[f]);i=!0}},o(a){for(let f=0;f<n.length;f+=1)pe(n[f]);i=!1},d(a){a&&(w(e),w(t)),o&&o.d(a);for(let f=0;f<n.length;f+=1)n[f].d()}}}function Wn(l){let e;function t(i,o){return i[5]?Zn:Xn}let n=t(l),s=n(l);return{c(){e=p("div"),s.c(),h(e,"class","empty svelte-1thvyca")},m(i,o){A(i,e,o),s.m(e,null)},p(i,o){n!==(n=t(i))&&(s.d(1),s=n(i),s&&(s.c(),s.m(e,null)))},i:x,o:x,d(i){i&&w(e),s.d()}}}function $n(l){let e,t,n,s,i;return{c(){e=p("div"),t=p("p"),t.textContent="Error loading videos",n=y(),s=p("p"),i=M(l[4]),h(t,"class","error-title svelte-1thvyca"),h(s,"class","error-message svelte-1thvyca"),h(e,"class","error svelte-1thvyca")},m(o,r){A(o,e,r),u(e,t),u(e,n),u(e,s),u(s,i)},p(o,r){r&16&&T(i,o[4])},i:x,o:x,d(o){o&&w(e)}}}function Gn(l){let e;return{c(){e=p("div"),e.innerHTML='<div class="spinner svelte-1thvyca"></div> <p class="svelte-1thvyca">Loading videos...</p>',h(e,"class","loading svelte-1thvyca")},m(t,n){A(t,e,n)},p:x,i:x,o:x,d(t){t&&w(e)}}}function Ot(l){let e,t;function n(o,r){return o[5]?Jn:Qn}let s=n(l),i=s(l);return{c(){e=p("div"),t=p("p"),i.c(),h(t,"class","result-count svelte-1thvyca"),h(e,"class","result-header svelte-1thvyca")},m(o,r){A(o,e,r),u(e,t),i.m(t,null)},p(o,r){s===(s=n(o))&&i?i.p(o,r):(i.d(1),i=s(o),i&&(i.c(),i.m(t,null)))},d(o){o&&w(e),i.d()}}}function Qn(l){let e=l[0].length+"",t,n;return{c(){t=M(e),n=M(" videos")},m(s,i){A(s,t,i),A(s,n,i)},p(s,i){i&1&&e!==(e=s[0].length+"")&&T(t,e)},d(s){s&&(w(t),w(n))}}}function Jn(l){let e,t=l[0].length+"",n,s,i,o;return{c(){e=M("Showing "),n=M(t),s=M(" of "),i=M(l[1]),o=M(" videos")},m(r,c){A(r,e,c),A(r,n,c),A(r,s,c),A(r,i,c),A(r,o,c)},p(r,c){c&1&&t!==(t=r[0].length+"")&&T(n,t),c&2&&T(i,r[1])},d(r){r&&(w(e),w(n),w(s),w(i),w(o))}}}function Nt(l,e){let t,n,s;return n=new Yn({props:{video:e[6],onClick:e[2]}}),{key:l,first:null,c(){t=wt(),Qe(n.$$.fragment),this.first=t},m(i,o){A(i,t,o),Ie(n,i,o),s=!0},p(i,o){e=i;const r={};o&1&&(r.video=e[6]),o&4&&(r.onClick=e[2]),n.$set(r)},i(i){s||(ae(n.$$.fragment,i),s=!0)},o(i){pe(n.$$.fragment,i),s=!1},d(i){i&&w(t),Oe(n,i)}}}function Xn(l){let e,t,n;return{c(){e=p("p"),e.textContent="No videos found in this archive.",t=y(),n=p("p"),n.textContent="Check that videos.tsv exists in the videos/ directory.",h(e,"class","svelte-1thvyca"),h(n,"class","hint svelte-1thvyca")},m(s,i){A(s,e,i),A(s,t,i),A(s,n,i)},d(s){s&&(w(e),w(t),w(n))}}}function Zn(l){let e,t,n;return{c(){e=p("p"),e.textContent="No videos match the current filters.",t=y(),n=p("p"),n.textContent="Try adjusting your search or filter criteria.",h(e,"class","svelte-1thvyca"),h(n,"class","hint svelte-1thvyca")},m(s,i){A(s,e,i),A(s,t,i),A(s,n,i)},d(s){s&&(w(e),w(t),w(n))}}}function xn(l){let e,t,n,s;const i=[Gn,$n,Wn,Kn],o=[];function r(c,a){return c[3]?0:c[4]?1:c[0].length===0?2:3}return t=r(l),n=o[t]=i[t](l),{c(){e=p("div"),n.c(),h(e,"class","video-list-container svelte-1thvyca")},m(c,a){A(c,e,a),o[t].m(e,null),s=!0},p(c,[a]){let f=t;t=r(c),t===f?o[t].p(c,a):(ct(),pe(o[f],1,1,()=>{o[f]=null}),ut(),n=o[t],n?n.p(c,a):(n=o[t]=i[t](c),n.c()),ae(n,1),n.m(e,null))},i(c){s||(ae(n),s=!0)},o(c){pe(n),s=!1},d(c){c&&w(e),o[t].d()}}}function es(l,e,t){let n,{videos:s}=e,{totalVideos:i=0}=e,{onVideoClick:o=()=>{}}=e,{loading:r=!1}=e,{error:c=null}=e;return l.$$set=a=>{"videos"in a&&t(0,s=a.videos),"totalVideos"in a&&t(1,i=a.totalVideos),"onVideoClick"in a&&t(2,o=a.onVideoClick),"loading"in a&&t(3,r=a.loading),"error"in a&&t(4,c=a.error)},l.$$.update=()=>{l.$$.dirty&3&&t(5,n=i>0&&s.length!==i)},[s,i,o,r,c,n]}class ts extends Ue{constructor(e){super(),He(this,e,es,xn,Ne,{videos:0,totalVideos:1,onVideoClick:2,loading:3,error:4})}}function Ht(l,e,t){const n=l.slice();return n[17]=e[t],n}function Ut(l){let e,t,n,s,i,o,r,c,a,f;return{c(){e=p("div"),t=p("button"),n=M("Play from Archive"),i=y(),o=p("button"),r=M("Play from YouTube"),h(t,"class","tab svelte-1qmy9il"),h(t,"role","tab"),h(t,"aria-selected",s=l[1]==="local"),h(t,"aria-controls","local-player-panel"),_e(t,"active",l[1]==="local"),h(o,"class","tab svelte-1qmy9il"),h(o,"role","tab"),h(o,"aria-selected",c=l[1]==="youtube"),h(o,"aria-controls","youtube-player-panel"),_e(o,"active",l[1]==="youtube"),h(e,"class","tabs svelte-1qmy9il"),h(e,"role","tablist")},m(d,_){A(d,e,_),u(e,t),u(t,n),u(e,i),u(e,o),u(o,r),a||(f=[H(t,"click",l[13]),H(o,"click",l[14])],a=!0)},p(d,_){_&2&&s!==(s=d[1]==="local")&&h(t,"aria-selected",s),_&2&&_e(t,"active",d[1]==="local"),_&2&&c!==(c=d[1]==="youtube")&&h(o,"aria-selected",c),_&2&&_e(o,"active",d[1]==="youtube")},d(d){d&&w(e),a=!1,ke(f)}}}function ls(l){let e,t,n,s,i,o,r,c,a=l[4]&&qt(l);return{c(){e=p("div"),a&&a.c(),t=y(),n=p("iframe"),Pe(n.src,s=l[9]())||h(n,"src",s),h(n,"title",i=l[0].title),h(n,"frameborder","0"),h(n,"allow","accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"),n.allowFullscreen=!0,h(n,"style",o=l[4]?"opacity: 0;":""),h(n,"class","svelte-1qmy9il"),h(e,"class","youtube-wrapper svelte-1qmy9il")},m(f,d){A(f,e,d),a&&a.m(e,null),u(e,t),u(e,n),r||(c=H(n,"load",l[11]),r=!0)},p(f,d){f[4]?a?a.p(f,d):(a=qt(f),a.c(),a.m(e,t)):a&&(a.d(1),a=null),d&1&&i!==(i=f[0].title)&&h(n,"title",i),d&16&&o!==(o=f[4]?"opacity: 0;":"")&&h(n,"style",o)},d(f){f&&w(e),a&&a.d(),r=!1,c()}}}function ns(l){let e;function t(i,o){return i[2]?is:ss}let n=t(l),s=n(l);return{c(){s.c(),e=wt()},m(i,o){s.m(i,o),A(i,e,o)},p(i,o){n===(n=t(i))&&s?s.p(i,o):(s.d(1),s=n(i),s&&(s.c(),s.m(e.parentNode,e)))},d(i){i&&w(e),s.d(i)}}}function qt(l){let e,t,n,s,i,o;return{c(){e=p("div"),t=p("img"),i=y(),o=p("div"),o.textContent="Loading...",Pe(t.src,n=l[8]())||h(t,"src",n),h(t,"alt",s=l[0].title),h(t,"class","thumbnail-placeholder svelte-1qmy9il"),h(o,"class","loading-spinner svelte-1qmy9il"),h(e,"class","youtube-loading svelte-1qmy9il")},m(r,c){A(r,e,c),u(e,t),u(e,i),u(e,o)},p(r,c){c&1&&s!==(s=r[0].title)&&h(t,"alt",s)},d(r){r&&w(e)}}}function ss(l){let e,t,n,s,i,o,r,c,a=me(l[5]),f=[];for(let d=0;d<a.length;d+=1)f[d]=Yt(Ht(l,a,d));return{c(){e=p("video"),t=p("source");for(let d=0;d<f.length;d+=1)f[d].c();s=p("p"),i=M(`Your browser doesn't support HTML5 video or the MKV format.
              `),o=p("button"),o.textContent="Watch on YouTube",Pe(t.src,n=l[7]())||h(t,"src",n),h(o,"class","fallback-button svelte-1qmy9il"),h(s,"class","video-fallback svelte-1qmy9il"),e.controls=!0,h(e,"crossorigin","anonymous"),h(e,"preload","metadata"),h(e,"poster",l[8]()),h(e,"class","svelte-1qmy9il")},m(d,_){A(d,e,_),u(e,t);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(e,null);u(e,s),u(s,i),u(s,o),r||(c=[H(o,"click",l[16]),H(e,"error",l[10]),H(e,"loadstart",rs),H(e,"loadedmetadata",as),H(e,"canplay",cs)],r=!0)},p(d,_){if(_&33){a=me(d[5]);let m;for(m=0;m<a.length;m+=1){const g=Ht(d,a,m);f[m]?f[m].p(g,_):(f[m]=Yt(g),f[m].c(),f[m].m(e,s))}for(;m<f.length;m+=1)f[m].d(1);f.length=a.length}},d(d){d&&w(e),Je(f,d),r=!1,ke(c)}}}function is(l){let e,t,n,s,i,o,r,c,a,f;return{c(){e=p("div"),t=p("p"),t.textContent="‚ö†Ô∏è Video Playback Error",n=y(),s=p("p"),i=M(l[3]),o=y(),r=p("div"),c=p("button"),c.textContent="Watch on YouTube instead",h(t,"class","error-title svelte-1qmy9il"),h(s,"class","error-details svelte-1qmy9il"),h(c,"class","error-button svelte-1qmy9il"),h(r,"class","error-actions svelte-1qmy9il"),h(e,"class","video-error-message svelte-1qmy9il")},m(d,_){A(d,e,_),u(e,t),u(e,n),u(e,s),u(s,i),u(e,o),u(e,r),u(r,c),a||(f=H(c,"click",l[15]),a=!0)},p(d,_){_&8&&T(i,d[3])},d(d){d&&w(e),a=!1,f()}}}function Yt(l){let e,t,n,s;return{c(){e=p("track"),h(e,"kind","subtitles"),Pe(e.src,t=`/videos/${l[0].file_path||l[0].video_id}/video.${l[17]}.vtt`)||h(e,"src",t),h(e,"srclang",n=l[17]),h(e,"label",s=l[17].toUpperCase())},m(i,o){A(i,e,o)},p(i,o){o&33&&!Pe(e.src,t=`/videos/${i[0].file_path||i[0].video_id}/video.${i[17]}.vtt`)&&h(e,"src",t),o&32&&n!==(n=i[17])&&h(e,"srclang",n),o&32&&s!==(s=i[17].toUpperCase())&&h(e,"label",s)},d(i){i&&w(e)}}}function os(l){let e,t,n,s,i,o,r=l[6]&&Ut(l);function c(d,_){if(d[1]==="local"&&d[6])return ns;if(d[1]==="youtube")return ls}let a=c(l),f=a&&a(l);return{c(){e=p("div"),r&&r.c(),t=y(),n=p("div"),s=p("div"),f&&f.c(),h(s,"class","tab-content svelte-1qmy9il"),h(s,"role","tabpanel"),h(s,"id",i=l[1]==="local"?"local-player-panel":"youtube-player-panel"),h(s,"aria-labelledby",o=l[1]==="local"?"local-tab":"youtube-tab"),h(n,"class","tab-content-wrapper svelte-1qmy9il"),h(e,"class","video-player svelte-1qmy9il")},m(d,_){A(d,e,_),r&&r.m(e,null),u(e,t),u(e,n),u(n,s),f&&f.m(s,null)},p(d,[_]){d[6]?r?r.p(d,_):(r=Ut(d),r.c(),r.m(e,t)):r&&(r.d(1),r=null),a===(a=c(d))&&f?f.p(d,_):(f&&f.d(1),f=a&&a(d),f&&(f.c(),f.m(s,null))),_&2&&i!==(i=d[1]==="local"?"local-player-panel":"youtube-player-panel")&&h(s,"id",i),_&2&&o!==(o=d[1]==="local"?"local-tab":"youtube-tab")&&h(s,"aria-labelledby",o)},i:x,o:x,d(d){d&&w(e),r&&r.d(),f&&f.d()}}}function rs(){console.log("[VideoPlayer] Video load started")}function as(){console.log("[VideoPlayer] Video metadata loaded")}function cs(){console.log("[VideoPlayer] Video can play")}function us(l,e,t){let n,s,{video:i}=e,o=i.download_status==="downloaded"?"local":"youtube",r=!1,c="",a=!0;function f(){const L=`/videos/${i.file_path||i.video_id}/video.mkv`;return console.log("[VideoPlayer] Video path:",L,"download_status:",i.download_status),L}function d(){return`/videos/${i.file_path||i.video_id}/thumbnail.jpg`}function _(){return`https://www.youtube.com/embed/${i.video_id}`}function m(S){t(2,r=!0);const L=S.target,O=L.error;if(console.error("[VideoPlayer] Video error event:",{error:O?{code:O.code,message:O.message}:"no error object",src:L.src,networkState:L.networkState,readyState:L.readyState}),O)switch(O.code){case O.MEDIA_ERR_ABORTED:t(3,c="Video loading was aborted. Please try again.");break;case O.MEDIA_ERR_NETWORK:t(3,c="Network error while loading video. Check your connection.");break;case O.MEDIA_ERR_DECODE:t(3,c="Video file is corrupted or in an unsupported format.");break;case O.MEDIA_ERR_SRC_NOT_SUPPORTED:t(3,c="Video file could not be loaded. You may need to run `git annex get` to download the file, or your browser may not support MKV format.");break;default:t(3,c="An unknown error occurred while loading the video.")}}function g(){t(4,a=!1)}function k(S){t(1,o=S),S==="local"?(t(2,r=!1),t(3,c="")):t(4,a=!0)}const b=()=>k("local"),C=()=>k("youtube"),v=()=>k("youtube"),E=()=>k("youtube");return l.$$set=S=>{"video"in S&&t(0,i=S.video)},l.$$.update=()=>{l.$$.dirty&1&&t(6,n=i.download_status==="downloaded"),l.$$.dirty&1&&t(5,s=i.captions_available||[])},[i,o,r,c,a,s,n,f,d,_,m,g,k,b,C,v,E]}class fs extends Ue{constructor(e){super(),He(this,e,us,os,Ne,{video:0})}}function Kt(l,e,t){const n=l.slice();return n[7]=e[t],n}function Wt(l,e,t){const n=l.slice();return n[10]=e[t],n}function ds(l){const e=l.slice(),t=e[1]!==void 0?e[1]:e[0].length;e[4]=t;const n=e[0].length>0;e[5]=n;const s=e[5]||e[1]===void 0;return e[6]=s,e}function $t(l){let e,t=l[4].toLocaleString()+"",n,s,i=l[4]!==1?"s":"",o,r,c,a,f=!l[6]&&l[1]!==void 0&&l[1]>0&&Gt();function d(g,k){return g[5]?_s:ps}let _=d(l),m=_(l);return{c(){e=p("h3"),n=M(t),s=M(" Comment"),o=M(i),r=y(),f&&f.c(),c=y(),m.c(),a=wt(),h(e,"class","svelte-799on6")},m(g,k){A(g,e,k),u(e,n),u(e,s),u(e,o),u(e,r),f&&f.m(e,null),A(g,c,k),m.m(g,k),A(g,a,k)},p(g,k){k&3&&t!==(t=g[4].toLocaleString()+"")&&T(n,t),k&3&&i!==(i=g[4]!==1?"s":"")&&T(o,i),!g[6]&&g[1]!==void 0&&g[1]>0?f||(f=Gt(),f.c(),f.m(e,null)):f&&(f.d(1),f=null),_===(_=d(g))&&m?m.p(g,k):(m.d(1),m=_(g),m&&(m.c(),m.m(a.parentNode,a)))},d(g){g&&(w(e),w(c),w(a)),f&&f.d(),m.d(g)}}}function hs(l){let e,t,n;return{c(){e=p("h3"),e.textContent="Loading comments...",t=y(),n=p("div"),n.innerHTML='<div class="spinner svelte-799on6"></div>',h(e,"class","svelte-799on6"),h(n,"class","loading-spinner svelte-799on6")},m(s,i){A(s,e,i),A(s,t,i),A(s,n,i)},p:x,d(s){s&&(w(e),w(t),w(n))}}}function Gt(l){let e;return{c(){e=p("span"),e.textContent="(not fetched)",h(e,"class","not-fetched svelte-799on6")},m(t,n){A(t,e,n)},d(t){t&&w(e)}}}function _s(l){let e,t=me(l[3]),n=[];for(let s=0;s<t.length;s+=1)n[s]=xt(Kt(l,t,s));return{c(){e=p("div");for(let s=0;s<n.length;s+=1)n[s].c();h(e,"class","comments-list svelte-799on6")},m(s,i){A(s,e,i);for(let o=0;o<n.length;o+=1)n[o]&&n[o].m(e,null)},p(s,i){if(i&8){t=me(s[3]);let o;for(o=0;o<t.length;o+=1){const r=Kt(s,t,o);n[o]?n[o].p(r,i):(n[o]=xt(r),n[o].c(),n[o].m(e,null))}for(;o<n.length;o+=1)n[o].d(1);n.length=t.length}},d(s){s&&w(e),Je(n,s)}}}function ps(l){let e;function t(i,o){return i[1]!==void 0&&i[1]>0?gs:ms}let n=t(l),s=n(l);return{c(){e=p("p"),s.c(),h(e,"class","no-comments svelte-799on6")},m(i,o){A(i,e,o),s.m(e,null)},p(i,o){n!==(n=t(i))&&(s.d(1),s=n(i),s&&(s.c(),s.m(e,null)))},d(i){i&&w(e),s.d()}}}function Qt(l){let e,t,n=l[7].like_count.toLocaleString()+"",s;return{c(){e=p("span"),t=M("üëç "),s=M(n),h(e,"class","likes svelte-799on6")},m(i,o){A(i,e,o),u(e,t),u(e,s)},p(i,o){o&8&&n!==(n=i[7].like_count.toLocaleString()+"")&&T(s,n)},d(i){i&&w(e)}}}function Jt(l){let e,t,n=l[7].replies.length+"",s,i,o=l[7].replies.length===1?"reply":"replies",r,c,a,f=me(l[7].replies),d=[];for(let _=0;_<f.length;_+=1)d[_]=Zt(Wt(l,f,_));return{c(){e=p("details"),t=p("summary"),s=M(n),i=y(),r=M(o),c=y(),a=p("div");for(let _=0;_<d.length;_+=1)d[_].c();h(t,"class","replies-summary svelte-799on6"),h(a,"class","replies svelte-799on6"),h(e,"class","replies-details svelte-799on6"),e.open=!0},m(_,m){A(_,e,m),u(e,t),u(t,s),u(t,i),u(t,r),u(e,c),u(e,a);for(let g=0;g<d.length;g+=1)d[g]&&d[g].m(a,null)},p(_,m){if(m&8&&n!==(n=_[7].replies.length+"")&&T(s,n),m&8&&o!==(o=_[7].replies.length===1?"reply":"replies")&&T(r,o),m&8){f=me(_[7].replies);let g;for(g=0;g<f.length;g+=1){const k=Wt(_,f,g);d[g]?d[g].p(k,m):(d[g]=Zt(k),d[g].c(),d[g].m(a,null))}for(;g<d.length;g+=1)d[g].d(1);d.length=f.length}},d(_){_&&w(e),Je(d,_)}}}function Xt(l){let e,t,n=l[10].like_count.toLocaleString()+"",s;return{c(){e=p("span"),t=M("üëç "),s=M(n),h(e,"class","likes svelte-799on6")},m(i,o){A(i,e,o),u(e,t),u(e,s)},p(i,o){o&8&&n!==(n=i[10].like_count.toLocaleString()+"")&&T(s,n)},d(i){i&&w(e)}}}function Zt(l){let e,t,n,s=l[10].author+"",i,o,r,c=Te(l[10].timestamp)+"",a,f,d,_=l[10].text+"",m,g,k,b,C=l[10].like_count>0&&Xt(l);return{c(){e=p("div"),t=p("div"),n=p("span"),i=M(s),o=y(),r=p("span"),a=M(c),f=y(),d=p("div"),m=M(_),g=y(),k=p("div"),C&&C.c(),b=y(),h(n,"class","author svelte-799on6"),h(r,"class","timestamp svelte-799on6"),h(t,"class","comment-header svelte-799on6"),h(d,"class","comment-text svelte-799on6"),h(k,"class","comment-meta svelte-799on6"),h(e,"class","comment reply svelte-799on6")},m(v,E){A(v,e,E),u(e,t),u(t,n),u(n,i),u(t,o),u(t,r),u(r,a),u(e,f),u(e,d),u(d,m),u(e,g),u(e,k),C&&C.m(k,null),u(e,b)},p(v,E){E&8&&s!==(s=v[10].author+"")&&T(i,s),E&8&&c!==(c=Te(v[10].timestamp)+"")&&T(a,c),E&8&&_!==(_=v[10].text+"")&&T(m,_),v[10].like_count>0?C?C.p(v,E):(C=Xt(v),C.c(),C.m(k,null)):C&&(C.d(1),C=null)},d(v){v&&w(e),C&&C.d()}}}function xt(l){let e,t,n,s=l[7].author+"",i,o,r,c=Te(l[7].timestamp)+"",a,f,d,_=l[7].text+"",m,g,k,b,C,v=l[7].like_count>0&&Qt(l),E=l[7].replies&&l[7].replies.length>0&&Jt(l);return{c(){e=p("div"),t=p("div"),n=p("span"),i=M(s),o=y(),r=p("span"),a=M(c),f=y(),d=p("div"),m=M(_),g=y(),k=p("div"),v&&v.c(),b=y(),E&&E.c(),C=y(),h(n,"class","author svelte-799on6"),h(r,"class","timestamp svelte-799on6"),h(t,"class","comment-header svelte-799on6"),h(d,"class","comment-text svelte-799on6"),h(k,"class","comment-meta svelte-799on6"),h(e,"class","comment svelte-799on6")},m(S,L){A(S,e,L),u(e,t),u(t,n),u(n,i),u(t,o),u(t,r),u(r,a),u(e,f),u(e,d),u(d,m),u(e,g),u(e,k),v&&v.m(k,null),u(e,b),E&&E.m(e,null),u(e,C)},p(S,L){L&8&&s!==(s=S[7].author+"")&&T(i,s),L&8&&c!==(c=Te(S[7].timestamp)+"")&&T(a,c),L&8&&_!==(_=S[7].text+"")&&T(m,_),S[7].like_count>0?v?v.p(S,L):(v=Qt(S),v.c(),v.m(k,null)):v&&(v.d(1),v=null),S[7].replies&&S[7].replies.length>0?E?E.p(S,L):(E=Jt(S),E.c(),E.m(e,C)):E&&(E.d(1),E=null)},d(S){S&&w(e),v&&v.d(),E&&E.d()}}}function ms(l){let e;return{c(){e=M("No comments available for this video.")},m(t,n){A(t,e,n)},d(t){t&&w(e)}}}function gs(l){let e;return{c(){e=M("Comments were not fetched for this video. Enable comments in the archive configuration to download them.")},m(t,n){A(t,e,n)},d(t){t&&w(e)}}}function vs(l){let e;function t(o,r){return o[2]?hs:$t}function n(o,r){return r===$t?ds(o):o}let s=t(l),i=s(n(l,s));return{c(){e=p("div"),i.c(),h(e,"class","comments-section svelte-799on6")},m(o,r){A(o,e,r),i.m(e,null)},p(o,[r]){s===(s=t(o))&&i?i.p(n(o,s),r):(i.d(1),i=s(n(o,s)),i&&(i.c(),i.m(e,null)))},i:x,o:x,d(o){o&&w(e),i.d()}}}function bs(l){const e=new Map,t=[];return l.forEach(n=>{e.set(n.comment_id,{...n,replies:[]})}),l.forEach(n=>{const s=e.get(n.comment_id);if(n.parent==="root")t.push(s);else{const i=e.get(n.parent);i?i.replies.push(s):t.push(s)}}),t}function ys(l,e,t){let n,{comments:s}=e,{commentCount:i=void 0}=e,{loading:o=!1}=e;return l.$$set=r=>{"comments"in r&&t(0,s=r.comments),"commentCount"in r&&t(1,i=r.commentCount),"loading"in r&&t(2,o=r.loading)},l.$$.update=()=>{l.$$.dirty&1&&t(3,n=bs(s))},[s,i,o,n]}class ks extends Ue{constructor(e){super(),He(this,e,ys,vs,Ne,{comments:0,commentCount:1,loading:2})}}function el(l){let e,t,n,s,i,o=new Date(l[1].published_at).toLocaleDateString()+"",r,c,a,f,d,_=il(l[1].duration)+"",m,g,k,b,C,v=l[1].download_status+"",E,S,L,O,F,D=l[1].tags&&l[1].tags.length>0&&tl(l),j=l[1].categories&&l[1].categories.length>0&&ll(l),P=l[1].captions_available.length>0&&nl(l),z=l[1].description&&sl(l);return{c(){e=p("div"),t=p("div"),n=p("div"),s=p("strong"),s.textContent="Published:",i=y(),r=M(o),c=y(),a=p("div"),f=p("strong"),f.textContent="Duration:",d=y(),m=M(_),g=y(),k=p("div"),b=p("strong"),b.textContent="Download Status:",C=y(),E=M(v),S=y(),D&&D.c(),L=y(),j&&j.c(),O=y(),P&&P.c(),F=y(),z&&z.c(),h(s,"class","svelte-1dygxzj"),h(f,"class","svelte-1dygxzj"),h(b,"class","svelte-1dygxzj"),h(t,"class","details-meta svelte-1dygxzj"),h(e,"class","details-content svelte-1dygxzj")},m(R,$){A(R,e,$),u(e,t),u(t,n),u(n,s),u(n,i),u(n,r),u(t,c),u(t,a),u(a,f),u(a,d),u(a,m),u(t,g),u(t,k),u(k,b),u(k,C),u(k,E),u(t,S),D&&D.m(t,null),u(t,L),j&&j.m(t,null),u(t,O),P&&P.m(t,null),u(t,F),z&&z.m(t,null)},p(R,$){$&2&&o!==(o=new Date(R[1].published_at).toLocaleDateString()+"")&&T(r,o),$&2&&_!==(_=il(R[1].duration)+"")&&T(m,_),$&2&&v!==(v=R[1].download_status+"")&&T(E,v),R[1].tags&&R[1].tags.length>0?D?D.p(R,$):(D=tl(R),D.c(),D.m(t,L)):D&&(D.d(1),D=null),R[1].categories&&R[1].categories.length>0?j?j.p(R,$):(j=ll(R),j.c(),j.m(t,O)):j&&(j.d(1),j=null),R[1].captions_available.length>0?P?P.p(R,$):(P=nl(R),P.c(),P.m(t,F)):P&&(P.d(1),P=null),R[1].description?z?z.p(R,$):(z=sl(R),z.c(),z.m(t,null)):z&&(z.d(1),z=null)},d(R){R&&w(e),D&&D.d(),j&&j.d(),P&&P.d(),z&&z.d()}}}function tl(l){let e,t,n,s=l[1].tags.join(", ")+"",i;return{c(){e=p("div"),t=p("strong"),t.textContent="Tags:",n=y(),i=M(s),h(t,"class","svelte-1dygxzj")},m(o,r){A(o,e,r),u(e,t),u(e,n),u(e,i)},p(o,r){r&2&&s!==(s=o[1].tags.join(", ")+"")&&T(i,s)},d(o){o&&w(e)}}}function ll(l){let e,t,n,s=l[1].categories.join(", ")+"",i;return{c(){e=p("div"),t=p("strong"),t.textContent="Categories:",n=y(),i=M(s),h(t,"class","svelte-1dygxzj")},m(o,r){A(o,e,r),u(e,t),u(e,n),u(e,i)},p(o,r){r&2&&s!==(s=o[1].categories.join(", ")+"")&&T(i,s)},d(o){o&&w(e)}}}function nl(l){let e,t,n,s=l[1].captions_available.join(", ")+"",i;return{c(){e=p("div"),t=p("strong"),t.textContent="Captions:",n=y(),i=M(s),h(t,"class","svelte-1dygxzj")},m(o,r){A(o,e,r),u(e,t),u(e,n),u(e,i)},p(o,r){r&2&&s!==(s=o[1].captions_available.join(", ")+"")&&T(i,s)},d(o){o&&w(e)}}}function sl(l){let e,t,n,s,i=l[1].description+"",o;return{c(){e=p("div"),t=p("strong"),t.textContent="Description:",n=y(),s=p("p"),o=M(i),h(t,"class","svelte-1dygxzj"),h(s,"class","svelte-1dygxzj"),h(e,"class","description-text svelte-1dygxzj")},m(r,c){A(r,e,c),u(e,t),u(e,n),u(e,s),u(s,o)},p(r,c){c&2&&i!==(i=r[1].description+"")&&T(o,i)},d(r){r&&w(e)}}}function Cs(l){let e,t,n,s,i,o,r,c,a=l[1].title+"",f,d,_,m,g,k=l[1].channel_name+"",b,C,v,E,S,L=at(l[1].view_count)+"",O,F,D,j,P,z=Te(l[1].published_at)+"",R,$,q,K,le,Z,te,J,Y,U=l[1].like_count.toLocaleString()+"",N,G,Ce,je,re,V,W=l[4]?"‚ñº":"‚ñ∂",ne,we,Ae,Ee,Me,fe,ge,Fe;i=new fs({props:{video:l[1]}});let X=l[4]&&el(l);return Me=new ks({props:{comments:l[2],commentCount:l[1].comment_count,loading:l[3]}}),{c(){e=p("div"),t=p("button"),t.textContent="‚Üê Back to list",n=y(),s=p("div"),Qe(i.$$.fragment),o=y(),r=p("div"),c=p("h1"),f=M(a),d=y(),_=p("div"),m=p("div"),g=p("span"),b=M(k),C=y(),v=p("span"),v.textContent="‚Ä¢",E=y(),S=p("span"),O=M(L),F=y(),D=p("span"),D.textContent="‚Ä¢",j=y(),P=p("span"),R=M(z),$=y(),q=p("div"),K=p("a"),le=M("View on YouTube ‚Üó"),te=y(),J=p("div"),Y=p("span"),N=M(U),G=y(),Ce=p("span"),Ce.textContent="likes",je=y(),re=p("div"),V=p("button"),ne=M(W),we=M(" Video Details"),Ae=y(),X&&X.c(),Ee=y(),Qe(Me.$$.fragment),h(t,"class","back-button svelte-1dygxzj"),h(s,"class","player-container svelte-1dygxzj"),h(c,"class","title svelte-1dygxzj"),h(g,"class","channel-name svelte-1dygxzj"),h(v,"class","separator svelte-1dygxzj"),h(S,"class","views"),h(D,"class","separator svelte-1dygxzj"),h(P,"class","date"),h(m,"class","metadata-left svelte-1dygxzj"),h(K,"href",Z=l[1].source_url),h(K,"target","_blank"),h(K,"rel","noopener noreferrer"),h(K,"class","youtube-link svelte-1dygxzj"),h(Y,"class","stat-value svelte-1dygxzj"),h(Ce,"class","stat-label svelte-1dygxzj"),h(J,"class","stat svelte-1dygxzj"),h(q,"class","metadata-right svelte-1dygxzj"),h(_,"class","metadata-row svelte-1dygxzj"),h(V,"class","details-toggle svelte-1dygxzj"),h(re,"class","details-section svelte-1dygxzj"),h(r,"class","video-info svelte-1dygxzj"),h(e,"class","video-detail svelte-1dygxzj")},m(ce,se){A(ce,e,se),u(e,t),u(e,n),u(e,s),Ie(i,s,null),u(e,o),u(e,r),u(r,c),u(c,f),u(r,d),u(r,_),u(_,m),u(m,g),u(g,b),u(m,C),u(m,v),u(m,E),u(m,S),u(S,O),u(m,F),u(m,D),u(m,j),u(m,P),u(P,R),u(_,$),u(_,q),u(q,K),u(K,le),u(q,te),u(q,J),u(J,Y),u(Y,N),u(J,G),u(J,Ce),u(r,je),u(r,re),u(re,V),u(V,ne),u(V,we),u(re,Ae),X&&X.m(re,null),u(e,Ee),Ie(Me,e,null),fe=!0,ge||(Fe=[H(t,"click",function(){Ct(l[0])&&l[0].apply(this,arguments)}),H(V,"click",l[6])],ge=!0)},p(ce,[se]){l=ce;const ie={};se&2&&(ie.video=l[1]),i.$set(ie),(!fe||se&2)&&a!==(a=l[1].title+"")&&T(f,a),(!fe||se&2)&&k!==(k=l[1].channel_name+"")&&T(b,k),(!fe||se&2)&&L!==(L=at(l[1].view_count)+"")&&T(O,L),(!fe||se&2)&&z!==(z=Te(l[1].published_at)+"")&&T(R,z),(!fe||se&2&&Z!==(Z=l[1].source_url))&&h(K,"href",Z),(!fe||se&2)&&U!==(U=l[1].like_count.toLocaleString()+"")&&T(N,U),(!fe||se&16)&&W!==(W=l[4]?"‚ñº":"‚ñ∂")&&T(ne,W),l[4]?X?X.p(l,se):(X=el(l),X.c(),X.m(re,null)):X&&(X.d(1),X=null);const Se={};se&4&&(Se.comments=l[2]),se&2&&(Se.commentCount=l[1].comment_count),se&8&&(Se.loading=l[3]),Me.$set(Se)},i(ce){fe||(ae(i.$$.fragment,ce),ae(Me.$$.fragment,ce),fe=!0)},o(ce){pe(i.$$.fragment,ce),pe(Me.$$.fragment,ce),fe=!1},d(ce){ce&&w(e),Oe(i),X&&X.d(),Oe(Me),ge=!1,ke(Fe)}}}function il(l){const e=Math.floor(l/3600),t=Math.floor(l%3600/60),n=l%60;return e>0?`${e}:${String(t).padStart(2,"0")}:${String(n).padStart(2,"0")}`:`${t}:${String(n).padStart(2,"0")}`}function ws(l,e,t){let{video:n}=e,{onBack:s}=e,i=n,o=[],r=!1,c=!1,a=!1;Al(async()=>{try{r=!0,t(1,i=await it.loadVideoMetadata(n.video_id))}catch(d){console.warn("Could not load full metadata, using TSV data:",d),t(1,i=n)}finally{r=!1}try{t(3,c=!0),t(2,o=await it.loadComments(n.video_id))}catch(d){console.warn("Could not load comments:",d),t(2,o=[])}finally{t(3,c=!1)}});const f=()=>t(4,a=!a);return l.$$set=d=>{"video"in d&&t(5,n=d.video),"onBack"in d&&t(0,s=d.onBack)},[s,i,o,c,a,n,f]}class As extends Ue{constructor(e){super(),He(this,e,ws,Cs,Ne,{video:5,onBack:0})}}class Es{filter(e,t,n){var i,o;let s=e;if(((i=t.dateRange)!=null&&i.from||(o=t.dateRange)!=null&&o.to)&&(s=s.filter(r=>{var d,_;const c=new Date(r.published_at),a=(d=t.dateRange)!=null&&d.from?new Date(t.dateRange.from):new Date(0),f=(_=t.dateRange)!=null&&_.to?new Date(t.dateRange.to):new Date;return c>=a&&c<=f})),t.channels&&t.channels.length>0&&(s=s.filter(r=>t.channels.includes(r.channel_id))),t.tags&&t.tags.length>0&&(s=s.filter(r=>r.tags.some(c=>t.tags.includes(c)))),t.downloadStatus&&t.downloadStatus.length>0&&(s=s.filter(r=>t.downloadStatus.includes(r.download_status))),t.playlists&&t.playlists.length>0){if(!n||n.length===0)return[];const r=new Set;n.forEach(c=>{t.playlists.includes(c.playlist_id)&&c.video_ids.forEach(a=>r.add(a))}),s=s.filter(c=>r.has(c.video_id))}return s}getUniqueChannels(e){const t=new Map;return e.forEach(n=>{n.channel_id&&!t.has(n.channel_id)&&t.set(n.channel_id,n.channel_name)}),Array.from(t.entries()).map(([n,s])=>({id:n,name:s})).sort((n,s)=>n.name.localeCompare(s.name))}getUniqueTags(e){const t=new Set;return e.forEach(n=>{n.tags&&n.tags.length>0&&n.tags.forEach(s=>t.add(s))}),Array.from(t).sort()}getPlaylistVideoCounts(e,t){const n=new Set(t.map(i=>i.video_id)),s=new Map;return e.forEach(i=>{const o=i.video_ids.filter(r=>n.has(r)).length;s.set(i.playlist_id,o)}),s}}const nt=new Es;class Ms{sort(e,t){const n=[...e];return n.sort((s,i)=>{let o=0;switch(t.field){case"views":o=s.view_count-i.view_count;break;case"date":o=new Date(s.published_at).getTime()-new Date(i.published_at).getTime();break;case"duration":o=s.duration-i.duration;break;case"comments":o=s.comment_count-i.comment_count;break;case"title":o=s.title.localeCompare(i.title);break;case"relevance":return 0}return t.direction==="asc"?o:-o}),n}}const Ss=new Ms;class Ds{parseHash(e){const t=e.replace(/^#\/?(\?)?/,""),n=new URLSearchParams(t),s=i=>{const o=i==null?void 0:i.split(",").filter(Boolean);return o!=null&&o.length?o:void 0};return{search:n.get("search")||void 0,dateFrom:n.get("from")||void 0,dateTo:n.get("to")||void 0,channels:s(n.get("channels")),tags:s(n.get("tags")),downloadStatus:s(n.get("status")),playlists:s(n.get("playlists")),sortField:n.get("sort")||void 0,sortDirection:n.get("dir")||void 0}}encodeHash(e){var s,i,o,r;const t=new URLSearchParams;e.search&&t.set("search",e.search),e.dateFrom&&t.set("from",e.dateFrom),e.dateTo&&t.set("to",e.dateTo),(s=e.channels)!=null&&s.length&&t.set("channels",e.channels.join(",")),(i=e.tags)!=null&&i.length&&t.set("tags",e.tags.join(",")),(o=e.downloadStatus)!=null&&o.length&&t.set("status",e.downloadStatus.join(",")),(r=e.playlists)!=null&&r.length&&t.set("playlists",e.playlists.join(",")),e.sortField&&t.set("sort",e.sortField),e.sortDirection&&t.set("dir",e.sortDirection);const n=t.toString();return n?`#/?${n}`:"#/"}updateHash(e){window.location.hash=this.encodeHash(e)}getCurrentState(){return this.parseHash(window.location.hash)}}const Fs=new Ds;function ol(l,e,t){const n=l.slice();return n[40]=e[t],n}function rl(l,e,t){const n=l.slice();return n[43]=e[t],n}function al(l,e,t){const n=l.slice();return n[46]=e[t],n}function cl(l){let e,t;return{c(){e=p("span"),t=M(l[12]),h(e,"class","count-badge svelte-z58pfr")},m(n,s){A(n,e,s),u(e,t)},p(n,s){s[0]&4096&&T(t,n[12])},d(n){n&&w(e)}}}function ul(l){let e,t,n,s,i,o,r,c,a,f,d,_,m,g,k,b,C,v,E,S,L,O,F,D,j,P,z,R,$,q,K,le,Z,te,J,Y,U,N,G,Ce,je,re,V,W,ne,we,Ae,Ee,Me=l[1].trim(),fe,ge,Fe,X,ce,se,ie=l[4].length>0&&fl(l),Se=me(l[15]),ue=[];for(let I=0;I<Se.length;I+=1)ue[I]=dl(al(l,Se,I));let de=l[0].length>0&&hl(l),he=l[14].length>0&&ml(l),ve=Me&&bl();return{c(){e=p("div"),t=p("div"),n=p("label"),n.textContent="Date Range",s=y(),i=p("div"),o=p("button"),o.textContent="Last Week",r=y(),c=p("button"),c.textContent="Last Month",a=y(),f=p("button"),f.textContent="Last Year",d=y(),_=p("button"),_.textContent="This Year",m=y(),g=p("button"),g.textContent="All Time",k=y(),b=p("div"),C=p("input"),v=y(),E=p("span"),E.textContent="to",S=y(),L=p("input"),O=y(),F=p("div"),D=p("label"),j=M(`Channels
        `),ie&&ie.c(),P=y(),z=p("select");for(let I=0;I<ue.length;I+=1)ue[I].c();R=y(),de&&de.c(),$=y(),he&&he.c(),q=y(),K=p("div"),le=p("label"),le.textContent="Video Availability",Z=y(),te=p("select"),J=p("option"),J.textContent="All Videos",Y=p("option"),Y.textContent="Backup Available (Local)",U=p("option"),U.textContent="Metadata Only",N=y(),G=p("div"),Ce=p("label"),Ce.textContent="Sort By",je=y(),re=p("div"),V=p("select"),W=p("option"),W.textContent="Date",ne=p("option"),ne.textContent="Views",we=p("option"),we.textContent="Comments",Ae=p("option"),Ae.textContent="Duration",Ee=p("option"),Ee.textContent="Title",ve&&ve.c(),fe=y(),ge=p("select"),Fe=p("option"),Fe.textContent="Descending",X=p("option"),X.textContent="Ascending",h(n,"class","filter-label svelte-z58pfr"),h(o,"type","button"),h(o,"class","preset-btn svelte-z58pfr"),_e(o,"active",l[11]==="week"),h(c,"type","button"),h(c,"class","preset-btn svelte-z58pfr"),_e(c,"active",l[11]==="month"),h(f,"type","button"),h(f,"class","preset-btn svelte-z58pfr"),_e(f,"active",l[11]==="year"),h(_,"type","button"),h(_,"class","preset-btn svelte-z58pfr"),_e(_,"active",l[11]==="thisyear"),h(g,"type","button"),h(g,"class","preset-btn svelte-z58pfr"),_e(g,"active",l[11]==="all"),h(i,"class","date-presets svelte-z58pfr"),h(C,"type","date"),h(C,"class","date-input svelte-z58pfr"),h(C,"title","From date"),h(E,"class","date-separator svelte-z58pfr"),h(L,"type","date"),h(L,"class","date-input svelte-z58pfr"),h(L,"title","To date"),h(b,"class","date-inputs svelte-z58pfr"),h(t,"class","filter-group svelte-z58pfr"),h(D,"class","filter-label svelte-z58pfr"),z.multiple=!0,h(z,"class","multi-select svelte-z58pfr"),h(z,"size","3"),l[4]===void 0&&Be(()=>l[30].call(z)),h(F,"class","filter-group svelte-z58pfr"),h(le,"class","filter-label svelte-z58pfr"),J.__value="all",Q(J,J.__value),Y.__value="downloaded",Q(Y,Y.__value),U.__value="metadata_only",Q(U,U.__value),h(te,"class","filter-select svelte-z58pfr"),l[6]===void 0&&Be(()=>l[33].call(te)),h(K,"class","filter-group svelte-z58pfr"),h(Ce,"class","filter-label svelte-z58pfr"),W.__value="date",Q(W,W.__value),ne.__value="views",Q(ne,ne.__value),we.__value="comments",Q(we,we.__value),Ae.__value="duration",Q(Ae,Ae.__value),Ee.__value="title",Q(Ee,Ee.__value),h(V,"class","sort-select svelte-z58pfr"),l[8]===void 0&&Be(()=>l[34].call(V)),Fe.__value="desc",Q(Fe,Fe.__value),X.__value="asc",Q(X,X.__value),h(ge,"class","sort-select svelte-z58pfr"),l[9]===void 0&&Be(()=>l[35].call(ge)),h(re,"class","sort-controls svelte-z58pfr"),h(G,"class","filter-group svelte-z58pfr"),h(e,"class","filters-grid svelte-z58pfr")},m(I,ee){A(I,e,ee),u(e,t),u(t,n),u(t,s),u(t,i),u(i,o),u(i,r),u(i,c),u(i,a),u(i,f),u(i,d),u(i,_),u(i,m),u(i,g),u(t,k),u(t,b),u(b,C),Q(C,l[2]),u(b,v),u(b,E),u(b,S),u(b,L),Q(L,l[3]),u(e,O),u(e,F),u(F,D),u(D,j),ie&&ie.m(D,null),u(F,P),u(F,z);for(let oe=0;oe<ue.length;oe+=1)ue[oe]&&ue[oe].m(z,null);Ge(z,l[4]),u(e,R),de&&de.m(e,null),u(e,$),he&&he.m(e,null),u(e,q),u(e,K),u(K,le),u(K,Z),u(K,te),u(te,J),u(te,Y),u(te,U),qe(te,l[6],!0),u(e,N),u(e,G),u(G,Ce),u(G,je),u(G,re),u(re,V),u(V,W),u(V,ne),u(V,we),u(V,Ae),u(V,Ee),ve&&ve.m(V,null),qe(V,l[8],!0),u(re,fe),u(re,ge),u(ge,Fe),u(ge,X),qe(ge,l[9],!0),ce||(se=[H(o,"click",l[23]),H(c,"click",l[24]),H(f,"click",l[25]),H(_,"click",l[26]),H(g,"click",l[27]),H(C,"input",l[28]),H(L,"input",l[29]),H(z,"change",l[30]),H(te,"change",l[33]),H(V,"change",l[34]),H(ge,"change",l[35])],ce=!0)},p(I,ee){if(ee[0]&2048&&_e(o,"active",I[11]==="week"),ee[0]&2048&&_e(c,"active",I[11]==="month"),ee[0]&2048&&_e(f,"active",I[11]==="year"),ee[0]&2048&&_e(_,"active",I[11]==="thisyear"),ee[0]&2048&&_e(g,"active",I[11]==="all"),ee[0]&4&&Q(C,I[2]),ee[0]&8&&Q(L,I[3]),I[4].length>0?ie?ie.p(I,ee):(ie=fl(I),ie.c(),ie.m(D,null)):ie&&(ie.d(1),ie=null),ee[0]&32768){Se=me(I[15]);let oe;for(oe=0;oe<Se.length;oe+=1){const Et=al(I,Se,oe);ue[oe]?ue[oe].p(Et,ee):(ue[oe]=dl(Et),ue[oe].c(),ue[oe].m(z,null))}for(;oe<ue.length;oe+=1)ue[oe].d(1);ue.length=Se.length}ee[0]&32784&&Ge(z,I[4]),I[0].length>0?de?de.p(I,ee):(de=hl(I),de.c(),de.m(e,$)):de&&(de.d(1),de=null),I[14].length>0?he?he.p(I,ee):(he=ml(I),he.c(),he.m(e,q)):he&&(he.d(1),he=null),ee[0]&64&&qe(te,I[6]),ee[0]&2&&(Me=I[1].trim()),Me?ve||(ve=bl(),ve.c(),ve.m(V,null)):ve&&(ve.d(1),ve=null),ee[0]&256&&qe(V,I[8]),ee[0]&512&&qe(ge,I[9])},d(I){I&&w(e),ie&&ie.d(),Je(ue,I),de&&de.d(),he&&he.d(),ve&&ve.d(),ce=!1,ke(se)}}}function fl(l){let e,t=l[4].length+"",n;return{c(){e=p("span"),n=M(t),h(e,"class","count-badge svelte-z58pfr")},m(s,i){A(s,e,i),u(e,n)},p(s,i){i[0]&16&&t!==(t=s[4].length+"")&&T(n,t)},d(s){s&&w(e)}}}function dl(l){let e,t=l[46].name+"",n,s;return{c(){e=p("option"),n=M(t),e.__value=s=l[46].id,Q(e,e.__value)},m(i,o){A(i,e,o),u(e,n)},p(i,o){o[0]&32768&&t!==(t=i[46].name+"")&&T(n,t),o[0]&32768&&s!==(s=i[46].id)&&(e.__value=s,Q(e,e.__value))},d(i){i&&w(e)}}}function hl(l){let e,t,n,s,i,o,r,c=l[7].length>0&&_l(l),a=me(l[0]),f=[];for(let d=0;d<a.length;d+=1)f[d]=pl(rl(l,a,d));return{c(){e=p("div"),t=p("label"),n=M(`Playlists
          `),c&&c.c(),s=y(),i=p("select");for(let d=0;d<f.length;d+=1)f[d].c();h(t,"class","filter-label svelte-z58pfr"),i.multiple=!0,h(i,"class","multi-select svelte-z58pfr"),h(i,"size","3"),l[7]===void 0&&Be(()=>l[31].call(i)),h(e,"class","filter-group svelte-z58pfr")},m(d,_){A(d,e,_),u(e,t),u(t,n),c&&c.m(t,null),u(e,s),u(e,i);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(i,null);Ge(i,l[7]),o||(r=H(i,"change",l[31]),o=!0)},p(d,_){if(d[7].length>0?c?c.p(d,_):(c=_l(d),c.c(),c.m(t,null)):c&&(c.d(1),c=null),_[0]&8193){a=me(d[0]);let m;for(m=0;m<a.length;m+=1){const g=rl(d,a,m);f[m]?f[m].p(g,_):(f[m]=pl(g),f[m].c(),f[m].m(i,null))}for(;m<f.length;m+=1)f[m].d(1);f.length=a.length}_[0]&129&&Ge(i,d[7])},d(d){d&&w(e),c&&c.d(),Je(f,d),o=!1,r()}}}function _l(l){let e,t=l[7].length+"",n;return{c(){e=p("span"),n=M(t),h(e,"class","count-badge svelte-z58pfr")},m(s,i){A(s,e,i),u(e,n)},p(s,i){i[0]&128&&t!==(t=s[7].length+"")&&T(n,t)},d(s){s&&w(e)}}}function pl(l){let e,t=l[43].title+"",n,s,i=(l[13].get(l[43].playlist_id)||0)+"",o,r,c;return{c(){e=p("option"),n=M(t),s=M(" ("),o=M(i),r=M(`)
            `),e.__value=c=l[43].playlist_id,Q(e,e.__value)},m(a,f){A(a,e,f),u(e,n),u(e,s),u(e,o),u(e,r)},p(a,f){f[0]&1&&t!==(t=a[43].title+"")&&T(n,t),f[0]&8193&&i!==(i=(a[13].get(a[43].playlist_id)||0)+"")&&T(o,i),f[0]&1&&c!==(c=a[43].playlist_id)&&(e.__value=c,Q(e,e.__value))},d(a){a&&w(e)}}}function ml(l){let e,t,n,s,i,o,r,c=l[5].length>0&&gl(l),a=me(l[14]),f=[];for(let d=0;d<a.length;d+=1)f[d]=vl(ol(l,a,d));return{c(){e=p("div"),t=p("label"),n=M(`Tags
          `),c&&c.c(),s=y(),i=p("select");for(let d=0;d<f.length;d+=1)f[d].c();h(t,"class","filter-label svelte-z58pfr"),i.multiple=!0,h(i,"class","multi-select svelte-z58pfr"),h(i,"size","3"),l[5]===void 0&&Be(()=>l[32].call(i)),h(e,"class","filter-group svelte-z58pfr")},m(d,_){A(d,e,_),u(e,t),u(t,n),c&&c.m(t,null),u(e,s),u(e,i);for(let m=0;m<f.length;m+=1)f[m]&&f[m].m(i,null);Ge(i,l[5]),o||(r=H(i,"change",l[32]),o=!0)},p(d,_){if(d[5].length>0?c?c.p(d,_):(c=gl(d),c.c(),c.m(t,null)):c&&(c.d(1),c=null),_[0]&16384){a=me(d[14]);let m;for(m=0;m<a.length;m+=1){const g=ol(d,a,m);f[m]?f[m].p(g,_):(f[m]=vl(g),f[m].c(),f[m].m(i,null))}for(;m<f.length;m+=1)f[m].d(1);f.length=a.length}_[0]&16416&&Ge(i,d[5])},d(d){d&&w(e),c&&c.d(),Je(f,d),o=!1,r()}}}function gl(l){let e,t=l[5].length+"",n;return{c(){e=p("span"),n=M(t),h(e,"class","count-badge svelte-z58pfr")},m(s,i){A(s,e,i),u(e,n)},p(s,i){i[0]&32&&t!==(t=s[5].length+"")&&T(n,t)},d(s){s&&w(e)}}}function vl(l){let e,t=l[40]+"",n,s;return{c(){e=p("option"),n=M(t),e.__value=s=l[40],Q(e,e.__value)},m(i,o){A(i,e,o),u(e,n)},p(i,o){o[0]&16384&&t!==(t=i[40]+"")&&T(n,t),o[0]&16384&&s!==(s=i[40])&&(e.__value=s,Q(e,e.__value))},d(i){i&&w(e)}}}function bl(l){let e;return{c(){e=p("option"),e.textContent="Relevance",e.__value="relevance",Q(e,e.__value)},m(t,n){A(t,e,n)},d(t){t&&w(e)}}}function yl(l){let e,t,n,s,i,o,r;return{c(){e=p("div"),t=p("button"),n=M("Clear All Filters ("),s=M(l[12]),i=M(")"),h(t,"class","clear-button svelte-z58pfr"),h(e,"class","footer svelte-z58pfr")},m(c,a){A(c,e,a),u(e,t),u(t,n),u(t,s),u(t,i),o||(r=H(t,"click",l[16]),o=!0)},p(c,a){a[0]&4096&&T(s,c[12])},d(c){c&&w(e),o=!1,r()}}}function Bs(l){let e,t,n,s,i,o,r,c,a=l[10]?"‚ñº":"‚ñ∂",f,d,_,m,g,k,b=l[12]>0&&!l[10]&&cl(l),C=l[10]&&ul(l),v=l[12]>0&&yl(l);return{c(){e=p("div"),t=p("div"),n=p("label"),n.textContent="Search",s=y(),i=p("input"),o=y(),r=p("button"),c=p("span"),f=M(a),d=M(`
    Filters
    `),b&&b.c(),_=y(),C&&C.c(),m=y(),v&&v.c(),h(n,"for","search-input"),h(n,"class","search-label svelte-z58pfr"),h(i,"id","search-input"),h(i,"type","text"),h(i,"placeholder","Search videos, channels, tags..."),h(i,"class","search-input svelte-z58pfr"),h(t,"class","search-section svelte-z58pfr"),h(c,"class","toggle-icon svelte-z58pfr"),h(r,"class","filters-toggle svelte-z58pfr"),h(e,"class","filter-panel svelte-z58pfr")},m(E,S){A(E,e,S),u(e,t),u(t,n),u(t,s),u(t,i),Q(i,l[1]),u(e,o),u(e,r),u(r,c),u(c,f),u(r,d),b&&b.m(r,null),u(e,_),C&&C.m(e,null),u(e,m),v&&v.m(e,null),g||(k=[H(i,"input",l[21]),H(r,"click",l[22])],g=!0)},p(E,S){S[0]&2&&i.value!==E[1]&&Q(i,E[1]),S[0]&1024&&a!==(a=E[10]?"‚ñº":"‚ñ∂")&&T(f,a),E[12]>0&&!E[10]?b?b.p(E,S):(b=cl(E),b.c(),b.m(r,null)):b&&(b.d(1),b=null),E[10]?C?C.p(E,S):(C=ul(E),C.c(),C.m(e,m)):C&&(C.d(1),C=null),E[12]>0?v?v.p(E,S):(v=yl(E),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i:x,o:x,d(E){E&&w(e),b&&b.d(),C&&C.d(),v&&v.d(),g=!1,ke(k)}}}function zs(l,e,t){let n,s,i,o,r,{videos:c}=e,{playlists:a=[]}=e,{onFilterChange:f}=e,d="",_="",m="",g=[],k=[],b="all",C=[],v="date",E="desc",S=!0,L=null,O;function F(){let V=c;d.trim()&&(V=Rl.search(d).map(ne=>ne.video)),V=nt.filter(V,{dateRange:_||m?{from:_||"1970-01-01",to:m||new Date().toISOString().split("T")[0]}:void 0,channels:g.length>0?g:void 0,tags:k.length>0?k:void 0,downloadStatus:n.length>0?n:void 0,playlists:C.length>0?C:void 0},a),V=Ss.sort(V,{field:v,direction:E}),j(),f(V)}let D;function j(){clearTimeout(D),D=setTimeout(()=>{Fs.updateHash({search:d||void 0,dateFrom:_||void 0,dateTo:m||void 0,channels:g.length>0?g:void 0,tags:k.length>0?k:void 0,downloadStatus:n.length>0?n:void 0,playlists:C.length>0?C:void 0,sortField:v,sortDirection:E})},500)}function P(){t(1,d=""),t(2,_=""),t(3,m=""),t(4,g=[]),t(5,k=[]),t(6,b="all"),t(7,C=[]),t(8,v="date"),t(9,E="desc")}function z(V){const W=new Date,ne=W.toISOString().split("T")[0];switch(t(11,L=V),V){case"week":const we=new Date(W.getTime()-6048e5);t(2,_=we.toISOString().split("T")[0]),t(3,m=ne);break;case"month":const Ae=new Date(W.getFullYear(),W.getMonth()-1,W.getDate());t(2,_=Ae.toISOString().split("T")[0]),t(3,m=ne);break;case"year":const Ee=new Date(W.getFullYear()-1,W.getMonth(),W.getDate());t(2,_=Ee.toISOString().split("T")[0]),t(3,m=ne);break;case"thisyear":t(2,_=`${W.getFullYear()}-01-01`),t(3,m=ne);break;case"lastyear":t(2,_=`${W.getFullYear()-1}-01-01`),t(3,m=`${W.getFullYear()-1}-12-31`);break;case"all":t(2,_=""),t(3,m="");break}}function R(){d=this.value,t(1,d)}const $=()=>t(10,S=!S),q=()=>z("week"),K=()=>z("month"),le=()=>z("year"),Z=()=>z("thisyear"),te=()=>z("all");function J(){_=this.value,t(2,_)}function Y(){m=this.value,t(3,m)}function U(){g=dt(this),t(4,g),t(15,s),t(18,c)}function N(){C=dt(this),t(7,C),t(0,a)}function G(){k=dt(this),t(5,k),t(14,i),t(18,c)}function Ce(){b=ft(this),t(6,b)}function je(){v=ft(this),t(8,v)}function re(){E=ft(this),t(9,E)}return l.$$set=V=>{"videos"in V&&t(18,c=V.videos),"playlists"in V&&t(0,a=V.playlists),"onFilterChange"in V&&t(19,f=V.onFilterChange)},l.$$.update=()=>{l.$$.dirty[0]&64&&(n=b==="all"?[]:b==="downloaded"?["downloaded"]:b==="metadata_only"?["metadata_only"]:[]),l.$$.dirty[0]&262144&&t(15,s=nt.getUniqueChannels(c)),l.$$.dirty[0]&262144&&t(14,i=nt.getUniqueTags(c)),l.$$.dirty[0]&262145&&t(13,o=nt.getPlaylistVideoCounts(a,c)),l.$$.dirty[0]&1048578&&(clearTimeout(O),t(20,O=setTimeout(()=>{F()},300))),l.$$.dirty[0]&1020&&F(),l.$$.dirty[0]&254&&t(12,r=[d.length>0,_.length>0||m.length>0,g.length>0,k.length>0,b!=="all",C.length>0].filter(Boolean).length),l.$$.dirty[0]&12},[a,d,_,m,g,k,b,C,v,E,S,L,r,o,i,s,P,z,c,f,O,R,$,q,K,le,Z,te,J,Y,U,N,G,Ce,je,re]}class Ts extends Ue{constructor(e){super(),He(this,e,zs,Bs,Ne,{videos:18,playlists:0,onFilterChange:19},null,[-1,-1])}}function kl(l){let e=l[0].length+"",t,n;return{c(){t=M(e),n=M(" videos archived")},m(s,i){A(s,t,i),A(s,n,i)},p(s,i){i&1&&e!==(e=s[0].length+"")&&T(t,e)},d(s){s&&(w(t),w(n))}}}function Ls(l){let e,t,n,s=!l[3]&&!l[4]&&Cl(l);return t=new ts({props:{videos:l[1],totalVideos:l[0].length,loading:l[3],error:l[4],onVideoClick:l[6]}}),{c(){s&&s.c(),e=y(),Qe(t.$$.fragment)},m(i,o){s&&s.m(i,o),A(i,e,o),Ie(t,i,o),n=!0},p(i,o){!i[3]&&!i[4]?s?(s.p(i,o),o&24&&ae(s,1)):(s=Cl(i),s.c(),ae(s,1),s.m(e.parentNode,e)):s&&(ct(),pe(s,1,1,()=>{s=null}),ut());const r={};o&2&&(r.videos=i[1]),o&1&&(r.totalVideos=i[0].length),o&8&&(r.loading=i[3]),o&16&&(r.error=i[4]),t.$set(r)},i(i){n||(ae(s),ae(t.$$.fragment,i),n=!0)},o(i){pe(s),pe(t.$$.fragment,i),n=!1},d(i){i&&w(e),s&&s.d(i),Oe(t,i)}}}function js(l){let e,t;return e=new As({props:{video:l[5],onBack:l[7]}}),{c(){Qe(e.$$.fragment)},m(n,s){Ie(e,n,s),t=!0},p(n,s){const i={};s&32&&(i.video=n[5]),e.$set(i)},i(n){t||(ae(e.$$.fragment,n),t=!0)},o(n){pe(e.$$.fragment,n),t=!1},d(n){Oe(e,n)}}}function Cl(l){let e,t;return e=new Ts({props:{videos:l[0],playlists:l[2],onFilterChange:l[8]}}),{c(){Qe(e.$$.fragment)},m(n,s){Ie(e,n,s),t=!0},p(n,s){const i={};s&1&&(i.videos=n[0]),s&4&&(i.playlists=n[2]),e.$set(i)},i(n){t||(ae(e.$$.fragment,n),t=!0)},o(n){pe(e.$$.fragment,n),t=!1},d(n){Oe(e,n)}}}function Rs(l){let e,t,n,s,i,o,r,c,a,f,d,_=!l[3]&&!l[4]&&kl(l);const m=[js,Ls],g=[];function k(b,C){return b[5]?0:1}return a=k(l),f=g[a]=m[a](l),{c(){e=p("main"),t=p("header"),n=p("div"),s=p("h1"),s.textContent="üìπ YouTube Archive Browser",i=y(),o=p("p"),_&&_.c(),r=y(),c=p("div"),f.c(),h(s,"class","svelte-1wq1yz8"),h(o,"class","subtitle svelte-1wq1yz8"),h(n,"class","header-content svelte-1wq1yz8"),h(t,"class","svelte-1wq1yz8"),h(c,"class","container svelte-1wq1yz8"),h(e,"class","svelte-1wq1yz8")},m(b,C){A(b,e,C),u(e,t),u(t,n),u(n,s),u(n,i),u(n,o),_&&_.m(o,null),u(e,r),u(e,c),g[a].m(c,null),d=!0},p(b,[C]){!b[3]&&!b[4]?_?_.p(b,C):(_=kl(b),_.c(),_.m(o,null)):_&&(_.d(1),_=null);let v=a;a=k(b),a===v?g[a].p(b,C):(ct(),pe(g[v],1,1,()=>{g[v]=null}),ut(),f=g[a],f?f.p(b,C):(f=g[a]=m[a](b),f.c()),ae(f,1),f.m(c,null))},i(b){d||(ae(f),d=!0)},o(b){pe(f),d=!1},d(b){b&&w(e),_&&_.d(),g[a].d()}}}function Vs(l,e,t){let n=[],s=[],i=[],o=!0,r=null;tt.getCurrentRoute();let c=null;Al(async()=>{try{t(0,n=await it.loadVideos()),t(1,s=n),Rl.initialize(n);try{t(2,i=await it.loadPlaylists())}catch(_){console.warn("Could not load playlists:",_),t(2,i=[])}t(3,o=!1)}catch(_){t(4,r=_ instanceof Error?_.message:"Unknown error loading archive"),t(3,o=!1)}tt.subscribe(_=>{if(_.name==="video"){const m=_.params.video_id;t(5,c=n.find(g=>g.video_id===m)||null)}else t(5,c=null)})});function a(_){tt.navigate("video",{video_id:_.video_id})}function f(){tt.navigate("home")}function d(_){t(1,s=_)}return[n,s,i,o,r,c,a,f,d]}class Ps extends Ue{constructor(e){super(),He(this,e,Vs,Rs,Ne,{})}}new Ps({target:document.getElementById("app")});
